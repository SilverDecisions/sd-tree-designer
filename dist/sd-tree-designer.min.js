require=function i(o,r,a){function l(t,e){if(!r[t]){if(!o[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(s)return s(t,!0);throw(n=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",n}n=r[t]={exports:{}},o[t][0].call(n.exports,function(e){return l(o[t][1][e]||e)},n,n.exports,i,o,r,a)}return r[t].exports}for(var s="function"==typeof require&&require,e=0;e<a.length;e++)l(a[e]);return l}({1:[function(e,t,n){"use strict";t.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i},t.exports.default=t.exports,t.exports.__esModule=!0},{}],2:[function(e,t,n){"use strict";var i=e("./arrayLikeToArray.js");t.exports=function(e){if(Array.isArray(e))return i(e)},t.exports.default=t.exports,t.exports.__esModule=!0},{"./arrayLikeToArray.js":1}],3:[function(e,t,n){"use strict";t.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},t.exports.default=t.exports,t.exports.__esModule=!0},{}],4:[function(e,t,n){"use strict";t.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},t.exports.default=t.exports,t.exports.__esModule=!0},{}],5:[function(e,t,n){"use strict";function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}t.exports=function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e},t.exports.default=t.exports,t.exports.__esModule=!0},{}],6:[function(e,t,n){"use strict";function i(e){return t.exports=i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},t.exports.default=t.exports,t.exports.__esModule=!0,i(e)}t.exports=i,t.exports.default=t.exports,t.exports.__esModule=!0},{}],7:[function(e,t,n){"use strict";var i=e("./setPrototypeOf.js");t.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)},t.exports.default=t.exports,t.exports.__esModule=!0},{"./setPrototypeOf.js":12}],8:[function(e,t,n){"use strict";t.exports=function(e){return e&&e.__esModule?e:{default:e}},t.exports.default=t.exports,t.exports.__esModule=!0},{}],9:[function(e,t,n){"use strict";t.exports=function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)},t.exports.default=t.exports,t.exports.__esModule=!0},{}],10:[function(e,t,n){"use strict";t.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.default=t.exports,t.exports.__esModule=!0},{}],11:[function(e,t,n){"use strict";var i=e("@babel/runtime/helpers/typeof").default,o=e("./assertThisInitialized.js");t.exports=function(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return o(e)},t.exports.default=t.exports,t.exports.__esModule=!0},{"./assertThisInitialized.js":3,"@babel/runtime/helpers/typeof":14}],12:[function(e,n,t){"use strict";function i(e,t){return n.exports=i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},n.exports.default=n.exports,n.exports.__esModule=!0,i(e,t)}n.exports=i,n.exports.default=n.exports,n.exports.__esModule=!0},{}],13:[function(e,t,n){"use strict";var i=e("./arrayWithoutHoles.js"),o=e("./iterableToArray.js"),r=e("./unsupportedIterableToArray.js"),a=e("./nonIterableSpread.js");t.exports=function(e){return i(e)||o(e)||r(e)||a()},t.exports.default=t.exports,t.exports.__esModule=!0},{"./arrayWithoutHoles.js":2,"./iterableToArray.js":9,"./nonIterableSpread.js":10,"./unsupportedIterableToArray.js":15}],14:[function(e,t,n){"use strict";function i(e){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?t.exports=i=function(e){return typeof e}:t.exports=i=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t.exports.default=t.exports,t.exports.__esModule=!0,i(e)}t.exports=i,t.exports.default=t.exports,t.exports.__esModule=!0},{}],15:[function(e,t,n){"use strict";var i=e("./arrayLikeToArray.js");t.exports=function(e,t){if(e){if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(n="Object"===n&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}},t.exports.default=t.exports,t.exports.__esModule=!0},{"./arrayLikeToArray.js":1}],16:[function(e,t,n){"use strict";var i=e("@babel/runtime/helpers/interopRequireDefault"),a=e("@babel/runtime/helpers/typeof");Object.defineProperty(n,"__esModule",{value:!0}),n.AppUtils=void 0;var r=i(e("@babel/runtime/helpers/classCallCheck")),l=i(e("@babel/runtime/helpers/createClass")),s=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};t=f(t);if(t&&t.has(e))return t.get(e);var n,i={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var r;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((r=o?Object.getOwnPropertyDescriptor(e,n):null)&&(r.get||r.set)?Object.defineProperty(i,n,r):i[n]=e[n])}i.default=e,t&&t.set(e,i);return i}(e("./d3")),u=e("./templates"),d=e("./i18n/i18n"),c=e("sd-utils");function f(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(f=function(e){return e?n:t})(e)}var o=function(){function o(){(0,r.default)(this,o)}return(0,l.default)(o,null,[{key:"placeTextWithEllipsis",value:function(e,t,n){var i=e.node();i.textContent=t;if(i.getComputedTextLength()>n+0){for(var o=t.length-3;0<o;--o)if(i.getSubStringLength(0,o)+9<=n+0)return i.textContent=t.substring(0,o)+"...",!0;return i.textContent="...",!0}return!1}},{key:"placeTextWithEllipsisAndTooltip",value:function(e,n,t,i){o.placeTextWithEllipsis(e,n,t)&&i&&(e.on("mouseover",function(e,t){i.transition().duration(200).style("opacity",.9),i.html(n).style("left",e.pageX+5+"px").style("top",e.pageY-28+"px")}),e.on("mouseout",function(e,t){i.transition().duration(500).style("opacity",0)}))}},{key:"getFontSize",value:function(e){return window.getComputedStyle(e,null).getPropertyValue("font-size")}},{key:"getTranslation",value:function(e){var t=document.createElementNS("http://www.w3.org/2000/svg","g");t.setAttributeNS(null,"transform",e);t=t.transform.baseVal.consolidate().matrix;return[t.e,t.f]}},{key:"closestPoint",value:function(e,n){for(var t,i,o,r,a,l,s,u,d,c=e.getTotalLength(),f=8,p=1/0,h=0;h<=c;h+=f)(r=g(o=e.getPointAtLength(h)))<p&&(t=o,i=h,p=r);for(f/=2;.5<f;)0<=(s=i-f)&&(u=g(a=e.getPointAtLength(s)))<p?(t=a,i=s,p=u):(s=i+f)<=c&&(d=g(l=e.getPointAtLength(s)))<p?(t=l,i=s,p=d):f/=2;return(t=[t.x,t.y]).distance=Math.sqrt(p),t;function g(e){var t=e.x-n[0],e=e.y-n[1];return t*t+e*e}}},{key:"growl",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"info",n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"right",i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:2e3,t=u.Templates.get("growl",{message:e,type:t}),o=s.select("body").selectOrAppend("div.sd-growl-list."+n).append("div").html(t);setTimeout(function(){o.remove()},i)}},{key:"createElement",value:function(e,t,n){e=document.createElement(e);return t&&o.deepExtend(e,t),n&&n.appendChild(e),e}},{key:"removeElement",value:function(e){e.parentNode.removeChild(e)}},{key:"replaceUrls",value:function(e){if(!e)return e;return e.replace(/((ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?)/,'<a href="$1" target="_blank">$1</a>')}},{key:"escapeHtml",value:function(e){var t=document.createTextNode(e),e=document.createElement("div");return e.appendChild(t),e.innerHTML}},{key:"dispatchHtmlEvent",value:function(e,t){var n;"createEvent"in document?((n=document.createEvent("HTMLEvents")).initEvent(t,!1,!0),e.dispatchEvent(n)):e.fireEvent("on"+t)}},{key:"dispatchEvent",value:function(t,n){var i;try{i=new CustomEvent(t,{detail:n})}catch(e){(i=document.createEvent("CustomEvent")).initCustomEvent(t,!1,!1,n)}document.dispatchEvent(i)}},{key:"getValidationMessage",value:function(e){var t="validation."+(e=c.Utils.isString(e)?{name:e}:e).name;return d.i18n.t(t,e.data)}},{key:"hide",value:function(e){e.classed("sd-hidden",!0)}},{key:"show",value:function(e){e.classed("sd-hidden",!(!(1<arguments.length&&void 0!==arguments[1])||arguments[1]))}},{key:"isHidden",value:function(e){return!e||(!(1<arguments.length&&void 0!==arguments[1])||arguments[1]?"none"===window.getComputedStyle(e).display:null===e.offsetParent)}},{key:"getJSON",value:function(e,t){var n=new XMLHttpRequest;n.open("get",e,!0),n.responseType="json",n.onload=function(){var e=n.status;200==e?t(n.response,null):t(null,e)},n.send()}}]),o}();(n.AppUtils=o).sanitizeHeight=function(e,t){return e||parseInt(t.style("height"),10)||400},o.sanitizeWidth=function(e,t){return e||parseInt(t.style("width"),10)||960},o.availableHeight=function(e,t,n){return Math.max(0,o.sanitizeHeight(e,t)-n.top-n.bottom)},o.availableWidth=function(e,t,n){return Math.max(0,o.sanitizeWidth(e,t)-n.left-n.right)}},{"./d3":23,"./i18n/i18n":27,"./templates":36,"@babel/runtime/helpers/classCallCheck":4,"@babel/runtime/helpers/createClass":5,"@babel/runtime/helpers/interopRequireDefault":8,"@babel/runtime/helpers/typeof":14,"sd-utils":"sd-utils"}],17:[function(e,t,n){"use strict";var i=e("@babel/runtime/helpers/interopRequireDefault"),a=e("@babel/runtime/helpers/typeof");Object.defineProperty(n,"__esModule",{value:!0}),n.ContextMenu=void 0;var r=i(e("@babel/runtime/helpers/classCallCheck")),o=i(e("@babel/runtime/helpers/createClass")),l=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var n,i={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var r;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((r=o?Object.getOwnPropertyDescriptor(e,n):null)&&(r.get||r.set)?Object.defineProperty(i,n,r):i[n]=e[n])}i.default=e,t&&t.set(e,i);return i}(e("../d3"));function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(s=function(e){return e?n:t})(e)}e=function(){function n(t,e){(0,r.default)(this,n);var o=this;return"function"==typeof e?o.openCallback=e:(o.openCallback=(e=e||{}).onOpen,o.closeCallback=e.onClose),l.selectAll(".d3-context-menu").data([1]).enter().append("div").attr("class","d3-context-menu"),l.select("body").on("click.d3-context-menu",function(){l.select(".d3-context-menu").style("display","none"),o.closeCallback&&o.closeCallback()}),function(e,n){var i=this;l.selectAll(".d3-context-menu").html(""),l.selectAll(".d3-context-menu").on("contextmenu",function(e,t){l.select(".d3-context-menu").style("display","none"),e.preventDefault(),e.stopPropagation()}).append("ul").selectAll("li").data("function"==typeof t?t(n):t).enter().append("li").attr("class",function(e){var t="";return e.divider&&(t+=" is-divider"),e.disabled&&(t+=" is-disabled"),e.action||(t+=" is-header"),t}).html(function(e){return e.divider?"<hr>":(e.title||console.error("No title attribute set. Check the spelling of your options."),"string"==typeof e.title?e.title:e.title(n))}).on("click",function(e,t){t.disabled||t.action&&(t.action(i,n),l.select(".d3-context-menu").style("display","none"),o.closeCallback&&o.closeCallback())}),o.openCallback&&!1===o.openCallback(e,n)||(l.select(".d3-context-menu").style("left",e.pageX-2+"px").style("top",e.pageY-2+"px").style("display","block"),e.preventDefault(),e.stopPropagation())}}return(0,o.default)(n,null,[{key:"hide",value:function(){l.select(".d3-context-menu").style("display","none")}}]),n}();n.ContextMenu=e},{"../d3":23,"@babel/runtime/helpers/classCallCheck":4,"@babel/runtime/helpers/createClass":5,"@babel/runtime/helpers/interopRequireDefault":8,"@babel/runtime/helpers/typeof":14}],18:[function(e,t,n){"use strict";var i=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.EdgeContextMenu=void 0;var o=i(e("@babel/runtime/helpers/classCallCheck")),r=i(e("@babel/runtime/helpers/inherits")),a=i(e("@babel/runtime/helpers/possibleConstructorReturn")),l=i(e("@babel/runtime/helpers/getPrototypeOf")),i=e("./context-menu"),s=e("../i18n/i18n");function u(n){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=(0,l.default)(n);return t=i?(e=(0,l.default)(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),(0,a.default)(this,t)}}i=function(e){(0,r.default)(n,e);var t=u(n);function n(i){(0,o.default)(this,n);var e;return(e=t.call(this,function(e){var t;return(t=[]).push({title:s.i18n.t("contextMenu.edge.injectDecisionNode"),action:function(e,t,n){i.injectDecisionNode(t)}}),t.push({title:s.i18n.t("contextMenu.edge.injectChanceNode"),action:function(e,t,n){i.injectChanceNode(t)}}),t})).treeDesigner=i,e}return n}(i.ContextMenu);n.EdgeContextMenu=i},{"../i18n/i18n":27,"./context-menu":17,"@babel/runtime/helpers/classCallCheck":4,"@babel/runtime/helpers/getPrototypeOf":6,"@babel/runtime/helpers/inherits":7,"@babel/runtime/helpers/interopRequireDefault":8,"@babel/runtime/helpers/possibleConstructorReturn":11}],19:[function(e,t,n){"use strict";var i=e("@babel/runtime/helpers/interopRequireDefault"),a=e("@babel/runtime/helpers/typeof");Object.defineProperty(n,"__esModule",{value:!0}),n.MainContextMenu=void 0;var r=i(e("@babel/runtime/helpers/classCallCheck")),o=i(e("@babel/runtime/helpers/inherits")),l=i(e("@babel/runtime/helpers/possibleConstructorReturn")),s=i(e("@babel/runtime/helpers/getPrototypeOf")),i=e("./context-menu"),u=e("sd-model"),d=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};t=f(t);if(t&&t.has(e))return t.get(e);var n,i={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var r;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((r=o?Object.getOwnPropertyDescriptor(e,n):null)&&(r.get||r.set)?Object.defineProperty(i,n,r):i[n]=e[n])}i.default=e,t&&t.set(e,i);return i}(e("../d3")),c=e("../i18n/i18n");function f(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(f=function(e){return e?n:t})(e)}function p(n){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=(0,s.default)(n);return t=i?(e=(0,s.default)(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),(0,l.default)(this,t)}}i=function(e){(0,o.default)(n,e);var t=p(n);function n(i){(0,r.default)(this,n);var e,o=null;return(e=t.call(this,function(e){var t;return(t=[]).push({title:c.i18n.t("contextMenu.main.addDecisionNode"),action:function(e,t){var n=new u.domain.DecisionNode(o);i.addNode(n)}}),t.push({title:c.i18n.t("contextMenu.main.addChanceNode"),action:function(e,t){var n=new u.domain.ChanceNode(o);i.addNode(n)}}),t.push({divider:!0}),t.push({title:c.i18n.t("contextMenu.main.addText"),action:function(e,t){var n=new u.domain.Text(o);i.addText(n)}}),t.push({divider:!0}),t.push({title:c.i18n.t("contextMenu.main.paste"),action:function(e,t){i.pasteToNewLocation(o)},disabled:!i.copiedNodes||!i.copiedNodes.length}),t.push({divider:!0}),t.push({title:c.i18n.t("contextMenu.main.selectAllNodes"),action:function(e,t){i.selectAllNodes()}}),t},{onOpen:function(e){i.clearSelection(),o=new u.domain.Point(d.pointer(e,i.svg.node())).move(i.getMainGroupTranslation(!0))}})).treeDesigner=i,e}return n}(i.ContextMenu);n.MainContextMenu=i},{"../d3":23,"../i18n/i18n":27,"./context-menu":17,"@babel/runtime/helpers/classCallCheck":4,"@babel/runtime/helpers/getPrototypeOf":6,"@babel/runtime/helpers/inherits":7,"@babel/runtime/helpers/interopRequireDefault":8,"@babel/runtime/helpers/possibleConstructorReturn":11,"@babel/runtime/helpers/typeof":14,"sd-model":"sd-model"}],20:[function(e,t,n){"use strict";var i=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.NodeContextMenu=void 0;var o=i(e("@babel/runtime/helpers/classCallCheck")),r=i(e("@babel/runtime/helpers/createClass")),a=i(e("@babel/runtime/helpers/inherits")),l=i(e("@babel/runtime/helpers/possibleConstructorReturn")),s=i(e("@babel/runtime/helpers/getPrototypeOf")),i=e("./context-menu"),u=e("sd-model"),d=e("../i18n/i18n");function c(n){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=(0,s.default)(n);return t=i?(e=(0,s.default)(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),(0,l.default)(this,t)}}i=function(e){(0,a.default)(s,e);var t=c(s);function s(a,l){(0,o.default)(this,s);var e;return(e=t.call(this,function(e){var t={title:d.i18n.t("contextMenu.node.copy"),action:function(e,t,n){a.selectNode(t,!a.isNodeSelected(t)),a.copySelectedNodes()}},n={title:d.i18n.t("contextMenu.node.cut"),action:function(e,t,n){a.selectNode(t,!a.isNodeSelected(t)),a.cutSelectedNodes()}},i={title:d.i18n.t("contextMenu.node.paste"),action:function(e,t,n){a.pasteToNode(t)},disabled:e.folded||!a.copiedNodes||!a.copiedNodes.length},o={title:d.i18n.t("contextMenu.node.delete"),action:function(e,t,n){a.selectNode(t,!a.isNodeSelected(t)),a.removeSelectedNodes()}},r=[];return e.type==u.domain.TerminalNode.$TYPE?(r=[t,n,o],s.addNodeConversionOptions(e,r,a)):(e.folded||(r.push({title:d.i18n.t("contextMenu.node.addDecisionNode"),action:function(e,t){a.addDecisionNode(t)}}),r.push({title:d.i18n.t("contextMenu.node.addChanceNode"),action:function(e,t){a.addChanceNode(t)}}),r.push({title:d.i18n.t("contextMenu.node.addTerminalNode"),action:function(e,t){a.addTerminalNode(t)}}),r.push({divider:!0})),r.push(t),r.push(n),r.push(i),r.push(o),s.addNodeConversionOptions(e,r,a),r.push({divider:!0}),r.push({title:d.i18n.t("contextMenu.node.selectSubtree"),action:function(e,t){a.selectSubTree(t,!0)}}),e.folded?r.push({title:d.i18n.t("contextMenu.node.unfold"),action:function(e,t){a.foldSubtree(t,!1)}}):r.push({title:d.i18n.t("contextMenu.node.fold"),action:function(e,t){a.foldSubtree(t)}}),!l||(o=l(e)).length&&(r.push({divider:!0}),o.forEach(function(n){r.push({title:d.i18n.t("contextMenu.node."+n.name),action:function(e,t){a.performOperation(t,n)},disabled:!n.canPerform(e)})}))),r})).treeDesigner=a,e}return(0,r.default)(s,null,[{key:"addNodeConversionOptions",value:function(e,t,n){n=s.getNodeConversionOptions(e,n);n.length&&(t.push({divider:!0}),n.forEach(function(e){return t.push(e)}))}},{key:"getNodeConversionOptions",value:function(t,n){var i=[];if(t.folded)return[];var e=[u.domain.DecisionNode.$TYPE,u.domain.ChanceNode.$TYPE,u.domain.TerminalNode.$TYPE];return!t.childEdges.length&&t.$parent?e.filter(function(e){return e!==t.type}).forEach(function(e){i.push(s.getNodeConversionOption(e,n))}):t instanceof u.domain.DecisionNode?i.push(s.getNodeConversionOption(u.domain.ChanceNode.$TYPE,n)):i.push(s.getNodeConversionOption(u.domain.DecisionNode.$TYPE,n)),i}},{key:"getNodeConversionOption",value:function(n,i){return{title:d.i18n.t("contextMenu.node.convert."+n),action:function(e,t){i.convertNode(t,n)}}}}]),s}(i.ContextMenu);n.NodeContextMenu=i},{"../i18n/i18n":27,"./context-menu":17,"@babel/runtime/helpers/classCallCheck":4,"@babel/runtime/helpers/createClass":5,"@babel/runtime/helpers/getPrototypeOf":6,"@babel/runtime/helpers/inherits":7,"@babel/runtime/helpers/interopRequireDefault":8,"@babel/runtime/helpers/possibleConstructorReturn":11,"sd-model":"sd-model"}],21:[function(e,t,n){"use strict";var i=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.TextContextMenu=void 0;var o=i(e("@babel/runtime/helpers/classCallCheck")),r=i(e("@babel/runtime/helpers/inherits")),a=i(e("@babel/runtime/helpers/possibleConstructorReturn")),l=i(e("@babel/runtime/helpers/getPrototypeOf")),i=e("./context-menu"),s=e("../i18n/i18n");function u(n){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=(0,l.default)(n);return t=i?(e=(0,l.default)(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),(0,a.default)(this,t)}}i=function(e){(0,r.default)(n,e);var t=u(n);function n(i){(0,o.default)(this,n);var e;return(e=t.call(this,function(e){var t,n={title:s.i18n.t("contextMenu.text.delete"),action:function(e,t,n){i.selectText(t,!0,!0),i.removeSelectedTexts()}};return(t=[]).push(n),t})).treeDesigner=i,e}return n}(i.ContextMenu);n.TextContextMenu=i},{"../i18n/i18n":27,"./context-menu":17,"@babel/runtime/helpers/classCallCheck":4,"@babel/runtime/helpers/getPrototypeOf":6,"@babel/runtime/helpers/inherits":7,"@babel/runtime/helpers/interopRequireDefault":8,"@babel/runtime/helpers/possibleConstructorReturn":11}],22:[function(e,t,n){"use strict";var i=e("@babel/runtime/helpers/interopRequireDefault"),a=e("@babel/runtime/helpers/typeof");Object.defineProperty(n,"__esModule",{value:!0}),n.D3Extensions=void 0;var r=i(e("@babel/runtime/helpers/classCallCheck")),l=i(e("@babel/runtime/helpers/createClass")),s=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};t=u(t);if(t&&t.has(e))return t.get(e);var n,i={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var r;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((r=o?Object.getOwnPropertyDescriptor(e,n):null)&&(r.get||r.set)?Object.defineProperty(i,n,r):i[n]=e[n])}i.default=e,t&&t.set(e,i);return i}(e("./d3"));function u(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(u=function(e){return e?n:t})(e)}n.D3Extensions=function(){function o(){(0,r.default)(this,o)}return(0,l.default)(o,null,[{key:"extend",value:function(){s.selection.prototype.enter.prototype.insertSelector=s.selection.prototype.insertSelector=function(e,t){return o.insertSelector(this,e,t)},s.selection.prototype.enter.prototype.appendSelector=s.selection.prototype.appendSelector=function(e){return o.appendSelector(this,e)},s.selection.prototype.enter.prototype.selectOrAppend=s.selection.prototype.selectOrAppend=function(e){return o.selectOrAppend(this,e)},s.selection.prototype.enter.prototype.selectOrInsert=s.selection.prototype.selectOrInsert=function(e,t){return o.selectOrInsert(this,e,t)}}},{key:"insertOrAppendSelector",value:function(e,t,n,i){for(var o=t.split(/([\.\#])/),r=e[n](o.shift(),i);1<o.length;){var a=o.shift(),l=o.shift();"."===a?r=r.classed(l,!0):"#"===a&&(r=r.attr("id",l))}return r}},{key:"insertSelector",value:function(e,t,n){return o.insertOrAppendSelector(e,t,"insert",n)}},{key:"appendSelector",value:function(e,t){return o.insertOrAppendSelector(e,t,"append")}},{key:"selectOrAppend",value:function(e,t,n){var i=e.select(t);return i.empty()?n?e.append(n):o.appendSelector(e,t):i}},{key:"selectOrInsert",value:function(e,t,n){var i=e.select(t);return i.empty()?o.insertSelector(e,t,n):i}}]),o}()},{"./d3":23,"@babel/runtime/helpers/classCallCheck":4,"@babel/runtime/helpers/createClass":5,"@babel/runtime/helpers/interopRequireDefault":8,"@babel/runtime/helpers/typeof":14}],23:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=e("d3-dispatch");Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in n&&n[e]===i[e]||Object.defineProperty(n,e,{enumerable:!0,get:function(){return i[e]}}))});var o=e("d3-scale");Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in n&&n[e]===o[e]||Object.defineProperty(n,e,{enumerable:!0,get:function(){return o[e]}}))});var r=e("d3-selection");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in n&&n[e]===r[e]||Object.defineProperty(n,e,{enumerable:!0,get:function(){return r[e]}}))});var a=e("d3-shape");Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in n&&n[e]===a[e]||Object.defineProperty(n,e,{enumerable:!0,get:function(){return a[e]}}))});var l=e("d3-drag");Object.keys(l).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in n&&n[e]===l[e]||Object.defineProperty(n,e,{enumerable:!0,get:function(){return l[e]}}))});var s=e("d3-brush");Object.keys(s).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in n&&n[e]===s[e]||Object.defineProperty(n,e,{enumerable:!0,get:function(){return s[e]}}))});var u=e("d3-array");Object.keys(u).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in n&&n[e]===u[e]||Object.defineProperty(n,e,{enumerable:!0,get:function(){return u[e]}}))});var d=e("d3-hierarchy");Object.keys(d).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in n&&n[e]===d[e]||Object.defineProperty(n,e,{enumerable:!0,get:function(){return d[e]}}))});var c=e("d3-time-format");Object.keys(c).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in n&&n[e]===c[e]||Object.defineProperty(n,e,{enumerable:!0,get:function(){return c[e]}}))})},{"d3-array":"d3-array","d3-brush":"d3-brush","d3-dispatch":"d3-dispatch","d3-drag":"d3-drag","d3-hierarchy":"d3-hierarchy","d3-scale":"d3-scale","d3-selection":"d3-selection","d3-shape":"d3-shape","d3-time-format":"d3-time-format"}],24:[function(e,t,n){t.exports={contextMenu:{main:{addDecisionNode:"Entscheidungsknoten hinzufügen",addChanceNode:"Zufall Knoten hinzufügen",addText:"Text hinzufügen ",paste:"Einfügen",selectAllNodes:"Alle Knoten auswählen"},node:{copy:"Kopieren",cut:"Ausschneiden",paste:"Einfügen",delete:"Löschen",addDecisionNode:"Entscheidungsknoten hinzufügen",addChanceNode:"Zufall Knoten hinzufügen",addTerminalNode:"Endknotten hinzufügen",convert:{decision:"Als Entscheidungsknoten",chance:"Als Zufall Knoten",terminal:"Als Endknoten"},selectSubtree:"Teilbaum wählen",fold:"Teilbaum falten",unfold:"Teilbaum entfalten",flipSubtree:"Teilbaum umdrehen",payoffsTransformation:"Auszahlungen transformieren"},edge:{injectDecisionNode:"Entscheidungsknoten Injizieren",injectChanceNode:"Zufall Knoten Injizieren"},text:{delete:"Löschen"}},validation:{incompletePath:"Pfad, der nicht mit dem Endknoten endet",probabilityDoNotSumUpTo1:"Die Summe der Wahrscheinlichkeiten ist nicht gleich 1",invalidProbability:"Ungültige Wahrscheinlichkeit im Zweig #{{number}}",invalidPayoff:"Ungültige Auszahlung in Zweig #{{number}}"},growl:{brushDisabled:"Auswahlbürste deaktiviert",brushEnabled:"Auswahlbürste aktiviert"},tooltip:{node:{payoff:{default:"Auszahlung {{number}}",named:"{{name}}"},aggregatedPayoff:{default:"Aggregierte Auszahlung {{number}}",named:"Aggregierte {{name}}"},probabilityToEnter:"Wahrscheinlichkeit"},edge:{payoff:{default:"Auszahlung {{number}}: {{value}}",named:"{{name}}: {{value}}"},probability:"Wahrscheinlichkeit: {{value}}"}}}},{}],25:[function(e,t,n){t.exports={contextMenu:{main:{addDecisionNode:"Add Decision Node",addChanceNode:"Add Chance Node",addText:"Add Text",paste:"Paste",selectAllNodes:"Select all nodes"},node:{copy:"Copy",cut:"Cut",paste:"Paste",delete:"Delete",addDecisionNode:"Add Decision Node",addChanceNode:"Add Chance Node",addTerminalNode:"Add Terminal Node",convert:{decision:"As Decision Node",chance:"As Chance Node",terminal:"As Terminal Node"},selectSubtree:"Select subtree",fold:"Fold subtree",unfold:"Unfold subtree",flipSubtree:"Flip subtree",payoffsTransformation:"Transform payoffs"},edge:{injectDecisionNode:"Inject Decision Node",injectChanceNode:"Inject Chance Node"},text:{delete:"Delete"}},validation:{incompletePath:"Path not ending with terminal node",probabilityDoNotSumUpTo1:"Probabilities do not sum up to 1",invalidProbability:"Invalid probability in edge #{{number}}",invalidPayoff:"Invalid payoff in edge #{{number}}"},growl:{brushDisabled:"Selection brush disabled",brushEnabled:"Selection brush enabled"},tooltip:{node:{payoff:{default:"Payoff {{number}}",named:"{{name}}"},aggregatedPayoff:{default:"Aggregated Payoff {{number}}",named:"Aggregated {{name}}"},probabilityToEnter:"Probability to enter"},edge:{payoff:{default:"Payoff {{number}}: {{value}}",named:"{{name}}: {{value}}"},probability:"Probability: {{value}}"}}}},{}],26:[function(e,t,n){t.exports={contextMenu:{main:{addDecisionNode:"Ajouter noud de décision",addChanceNode:"Ajouter noud aléatoire",addText:"Ajouter du texte",paste:"Coller",selectAllNodes:"Sélectionner tous les nouds"},node:{copy:"Copie",cut:"Couper",paste:"Coller",delete:"Effacer",addDecisionNode:"Ajouter noud de décision",addChanceNode:"Ajouter noud aléatoire",addTerminalNode:"Ajouter un noeud terminal",convert:{decision:"Comme noud de décision",chance:"Comme noud aléatoire",terminal:"Comme un noeud terminal"},selectSubtree:"Sélectionner une sous-arborescence",fold:"Plier sous-arbre",unfold:"Déplier arbre sous-arbre",flipSubtree:"Basculer sous-arbre",payoffsTransformation:"Transformez les gains"},edge:{injectDecisionNode:"Injecter un noeud de décision",injectChanceNode:"Injecter un noeud de chance"},text:{delete:"Effacer"}},validation:{incompletePath:"Parcours non terminé par noeud terminal",probabilityDoNotSumUpTo1:"La somme des probabilités n'est pas 1 ou plus",invalidProbability:"Probabilité invalide - le bord #{{number}}",invalidPayoff:"Avantage invalide - le bord #{{number}}"},growl:{brushDisabled:"Brosse de sélection désactivée",brushEnabled:"Brosse de sélection activée"},tooltip:{node:{payoff:{default:"Avantage {{number}}",named:"{{name}}"},aggregatedPayoff:{default:"Avantage agrégé {{number}}",named:"Agrégé  {{name}}"},probabilityToEnter:"Probabilité d'entrée"},edge:{payoff:{default:"Avantage {{number}}: {{value}}",named:"{{name}}: {{value}}"},probability:"Probabilité: {{value}}"}}}},{}],27:[function(e,t,n){"use strict";var i=e("@babel/runtime/helpers/interopRequireDefault"),a=e("@babel/runtime/helpers/typeof");Object.defineProperty(n,"__esModule",{value:!0}),n.i18n=void 0;var o=i(e("@babel/runtime/helpers/classCallCheck")),r=i(e("@babel/runtime/helpers/createClass")),l=i(e("i18next")),s=g(e("./en.json")),u=g(e("./pl.json")),d=g(e("./it.json")),c=g(e("./de.json")),f=g(e("./fr.json")),p=g(e("./pt-br.json"));function h(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(h=function(e){return e?n:t})(e)}function g(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};t=h(t);if(t&&t.has(e))return t.get(e);var n,i,o={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((i=r?Object.getOwnPropertyDescriptor(e,n):null)&&(i.get||i.set)?Object.defineProperty(o,n,i):o[n]=e[n]);return o.default=e,t&&t.set(e,o),o}n.i18n=function(){function n(){(0,o.default)(this,n)}return(0,r.default)(n,null,[{key:"init",value:function(e){n.language=e,n.$instance=l.default.createInstance({lng:e,fallbackLng:"en",resources:{en:{translation:s},pl:{translation:u},it:{translation:d},de:{translation:c},fr:{translation:f},"pt-BR":{translation:p}}},function(e,t){})}},{key:"t",value:function(e,t){return n.$instance.t(e,t)}}]),n}()},{"./de.json":24,"./en.json":25,"./fr.json":26,"./it.json":28,"./pl.json":29,"./pt-br.json":30,"@babel/runtime/helpers/classCallCheck":4,"@babel/runtime/helpers/createClass":5,"@babel/runtime/helpers/interopRequireDefault":8,"@babel/runtime/helpers/typeof":14,i18next:"i18next"}],28:[function(e,t,n){t.exports={contextMenu:{main:{addDecisionNode:"Aggiungi un nodo di decisione",addChanceNode:"Aggiungi un nodo opportunità",addText:"Aggiungi testo",paste:"Incolla",selectAllNodes:"Seleziona tutti i nodi"},node:{copy:"Copia",cut:"Taglia",paste:"Incolla",delete:"Cancella",addDecisionNode:"Aggiungi un nodo di decisione",addChanceNode:"Aggiungi un nodo opportunità",addTerminalNode:"Aggiungi un nodo terminale",convert:{decision:"Come Decision Node",chance:"Come Chance Node",terminal:"Come Terminal Node"},selectSubtree:"Seleziona Sotto-albero",fold:"Piega sotto-albero",unfold:"Dispiegarsi sotto-albero",flipSubtree:"Ribalta sotto-albero",payoffsTransformation:"Trasforma i profitti"},edge:{injectDecisionNode:"Inietta nodo di decisione",injectChanceNode:"Inietta nodo opportunità"},text:{delete:"Cancella"}},validation:{incompletePath:"Percorso senza nodo terminale",probabilityDoNotSumUpTo1:"La somma delle probabilità è diversa da 1",invalidProbability:"Probabilità non valida - bordo #{{number}}",invalidPayoff:"Saldo non valido - bordo #{{number}}"},growl:{brushDisabled:"Selezione pennello disabilitata",brushEnabled:"Selezione pennello abilitata"},tooltip:{node:{payoff:{default:"Saldo {{number}}",named:"{{name}}"},aggregatedPayoff:{default:"Saldo aggregato {{number}}",named:"Aggregato {{name}}"},probabilityToEnter:"Probabilità da inserire"},edge:{payoff:{default:"Saldo {{number}}: {{value}}",named:"{{name}}: {{value}}"},probability:"Probabilità: {{value}}"}}}},{}],29:[function(e,t,n){t.exports={contextMenu:{main:{addDecisionNode:"Dodaj Węzeł Decyzyjny",addChanceNode:"Dodaj Węzeł Losowy",addText:"Dodaj Tekst",paste:"Wklej",selectAllNodes:"Zaznacz wszystkie węzły"},node:{copy:"Kopiuj",cut:"Wytnij",paste:"Wklej",delete:"Usuń",addDecisionNode:"Dodaj Węzeł Decyzyjny",addChanceNode:"Dodaj Węzeł Losowy",addTerminalNode:"Dodaj Węzeł Końcowy",convert:{decision:"Jako Węzeł Decyzyjny",chance:"Jako Węzeł Losowy",terminal:"Jako Węzeł Końcowy"},selectSubtree:"Zaznacz poddrzewo",fold:"Zwiń poddrzewo",unfold:"Rozwiń poddrzewo",flipSubtree:"Przewróć poddrzewo",payoffsTransformation:"Przekształć wypłaty"},edge:{injectDecisionNode:"Wstrzyknij Węzeł Decyzyjny",injectChanceNode:"Wstrzyknij Węzeł Losowy"},text:{delete:"Usuń"}},validation:{incompletePath:"Ostatnim węzłem w ścieżce powinien być Węzeł Końcowy",probabilityDoNotSumUpTo1:"Prawdopodobieństwa nie sumują sie do 1",invalidProbability:"Niepoprawne prawdopodobieństwo na krawędzi #{{number}}",invalidPayoff:"Niepoprawna wypłata na krawędzi #{{number}}"},growl:{brushDisabled:"Zaznaczanie wyłączone",brushEnabled:"Zaznaczanie włączone"},tooltip:{node:{payoff:{default:"Wypłata {{number}}",named:"{{name}}"},aggregatedPayoff:{default:"Zagregowana wypłata {{number}}",named:"Zagregowana {{name}}"},probabilityToEnter:"Prawdopodobieństwo wejścia"},edge:{payoff:{default:"Wypłata {{number}}: {{value}}",named:"{{name}}: {{value}}"},probability:"Prawdopodobieństwo: {{value}}"}}}},{}],30:[function(e,t,n){t.exports={contextMenu:{main:{addDecisionNode:"Adicionar nó de decisão",addChanceNode:"Adicionar Nó de probabilidade",addText:"Adicionar Texto",paste:"Colar",selectAllNodes:"Selecionar todos os nós"},node:{copy:"Copiar",cut:"Cortar",paste:"Colar",delete:"Excluir",addDecisionNode:"Adicionar nó de decisão",addChanceNode:"Adicionar Nó de chance",addTerminalNode:"Adicionar Nó Terminal",convert:{decision:"Como nó de decisão",chance:"Como Nó de Chance",terminal:"Como Nó Terminal"},selectSubtree:"Selecionar subárvore",fold:"Dobrar subárvore",unfold:"Desdobrar subárvore",flipSubtree:"Inverter subárvore",payoffsTransformation:"Transformar pesos"},edge:{injectDecisionNode:"Injetar Nó de Decisão",injectChanceNode:"Injetar Nó de Chance"},text:{delete:"Excluir"}},validation:{incompletePath:"O caminho não termina com o nó terminal",probabilityDoNotSumUpTo1:"Probabilidades não somam até 1",invalidProbability:"Probabilidade inválida na borda # {{number}}",invalidPayoff:"Pagamento inválido na borda # {{number}}"},growl:{brushDisabled:"Pincel de seleção desativado",brushEnabled:"Pincel de seleção habilitado"},tooltip:{node:{payoff:{default:"Pagar {{number}}",named:"{{name}}"},aggregatedPayoff:{default:"Pagar agregado {{number}}",named:"Agregado {{name}}"},probabilityToEnter:"Probabilidade de entrar"},edge:{payoff:{default:"Pagar {{number}}: {{value}}",named:"{{name}}: {{value}}"},probability:"Probabilidade: {{value}}"}}}},{}],31:[function(e,t,n){"use strict";var i=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0});var o={d3:!0};Object.defineProperty(n,"d3",{enumerable:!0,get:function(){return d.default}});var r=e("./d3-extensions");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(o,e)||e in n&&n[e]===r[e]||Object.defineProperty(n,e,{enumerable:!0,get:function(){return r[e]}}))});var a=e("./tree-designer");Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(o,e)||e in n&&n[e]===a[e]||Object.defineProperty(n,e,{enumerable:!0,get:function(){return a[e]}}))});var l=e("./app-utils");Object.keys(l).forEach(function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(o,e)||e in n&&n[e]===l[e]||Object.defineProperty(n,e,{enumerable:!0,get:function(){return l[e]}}))});var s=e("./templates");Object.keys(s).forEach(function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(o,e)||e in n&&n[e]===s[e]||Object.defineProperty(n,e,{enumerable:!0,get:function(){return s[e]}}))});var u=e("./tooltip");Object.keys(u).forEach(function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(o,e)||e in n&&n[e]===u[e]||Object.defineProperty(n,e,{enumerable:!0,get:function(){return u[e]}}))});var d=i(e("./d3"));r.D3Extensions.extend()},{"./app-utils":16,"./d3":23,"./d3-extensions":22,"./templates":36,"./tooltip":39,"./tree-designer":40,"@babel/runtime/helpers/interopRequireDefault":8}],32:[function(e,t,n){"use strict";var i=e("@babel/runtime/helpers/interopRequireDefault"),a=e("@babel/runtime/helpers/typeof");Object.defineProperty(n,"__esModule",{value:!0}),n.Layout=void 0;var o=i(e("@babel/runtime/helpers/classCallCheck")),r=i(e("@babel/runtime/helpers/createClass")),u=e("sd-utils"),d=e("sd-model"),c=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var n,i={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var r;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((r=o?Object.getOwnPropertyDescriptor(e,n):null)&&(r.get||r.set)?Object.defineProperty(i,n,r):i[n]=e[n])}i.default=e,t&&t.set(e,i);return i}(e("./d3")),l=i(e("./symbols/circle")),f=i(e("./symbols/triangle")),p=e("./app-utils");function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(s=function(e){return e?n:t})(e)}e=function(){function s(e,t,n){(0,o.default)(this,s),this.nodeTypeToSymbol={decision:c.symbolSquare,chance:l.default,terminal:f.default},this.onAutoLayoutChanged=[],this.nodeTypeOrder={decision:0,chance:0,terminal:1},this.treeMargin=50,this.targetSymbolSize={},this.nodeSeparation=function(e,t){return e.parent===t.parent?1:1.2},this.nodeSymbolSize={},this.treeDesigner=e,this.data=t,this.config=n}return(0,r.default)(s,[{key:"update",value:function(e){if(e&&e.$parent&&e.$parent.childEdges.sort(function(e,t){return e.childNode.location.y-t.childNode.location.y}),!this.isManualLayout())return this.autoLayout(this.config.type,!0);e?this.moveNodeToEmptyPlace(e):this.treeDesigner.redraw(!0)}},{key:"isManualLayout",value:function(){return this.config.type===s.MANUAL_LAYOUT_NAME}},{key:"getNewChildLocation",value:function(e){if(!e)return new d.domain.Point(this.getNodeMinX(),this.getNodeMinY());var t=e.location.x+this.config.gridWidth,n=e.location.y;return e.childEdges.length&&(n=e.childEdges[e.childEdges.length-1].childNode.location.y+1),new d.domain.Point(t,n)}},{key:"getInjectedNodeLocation",value:function(e){e=e.$linePoints[2];return new d.domain.Point(e[0],e[1])}},{key:"moveNodeToEmptyPlace",value:function(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],r=this;e.location.x=Math.max(this.getNodeMinX(e),e.location.x),e.location.y=Math.max(this.getNodeMinY(e),e.location.y),this.nodesSortedByX=this.data.nodes.slice(),this.nodesSortedByX.sort(function(e,t){return e.location.x-t.location.x});for(var n,i=this.config.nodeSize/2,o=this.config.nodeSize+10,a=!1,l=new d.domain.Point(e.location);n=function(i,o){return u.Utils.find(r.nodesSortedByX,function(e){if(i==e)return!1;var t=r.config.nodeSize/3,n=e.location.x,e=e.location.y;return o.x-t<=n&&o.x+t>=n&&o.y-t<=e&&o.y+t>=e})}(e,l);){a=!0;e.$parent&&n.$parent&&e.$parent===n.$parent?l.move(0,75):l.move(i,o)}a&&(e.moveTo(l.x,l.y,!0),t&&this.treeDesigner.redraw(!0))}},{key:"disableAutoLayout",value:function(){this.config.type=s.MANUAL_LAYOUT_NAME,this._fireOnAutoLayoutChangedCallbacks()}},{key:"drawNodeSymbol",value:function(e,o){var r=this,a=this.config.nodeSize;this.nodeSymbol=c.symbol().type(function(e){return r.nodeTypeToSymbol[e.type]}).size(function(e){return r.nodeSymbolSize[e.id]?u.Utils.get(r.targetSymbolSize,e.type+"['"+r.config.nodeSize+"']",64):64}),e.each(function(e){var t=c.select(this);t.attr("d")||t.attr("d",r.nodeSymbol);var n,i=u.Utils.get(r.targetSymbolSize,e.type+"['"+r.config.nodeSize+"']");i||(n=t.node().getBBox(),i=(n=Math.min(a/n.width,a/n.height))*n*(r.nodeSymbolSize[e.id]||64),u.Utils.set(r.targetSymbolSize,e.type+"['"+r.config.nodeSize+"']",i)),o?t=t.transition():r.nodeSymbolSize[e.id]=i,t.attr("d",r.nodeSymbol),o&&(r.nodeSymbolSize[e.id]=i)})}},{key:"nodeLabelPosition",value:function(e){return e.attr("x",0).attr("y",-this.config.nodeSize/2-7)}},{key:"nodePayoffPosition",value:function(e){return s.setHangingPosition(e).attr("x",0).attr("y",this.config.nodeSize/2+7).attr("text-anchor","middle")}},{key:"nodeAggregatedPayoffPosition",value:function(e){var t=this.config.nodeSize/2+7,n=this;return e.attr("x",t).attr("y",function(e){var t=parseInt(p.AppUtils.getFontSize(this)),e=e.displayValue("aggregatedPayoff");return 1<(u.Utils.isArray(e)?e.filter(function(e){return void 0!==e}).length:1)?-this.getBBox().height/2+t/2:-Math.max(2,1.8*n.config.nodeSize/t)}),e.selectAll("tspan").attr("x",t),e}},{key:"nodeProbabilityToEnterPosition",value:function(e){var n=this;return s.setHangingPosition(e).attr("x",this.config.nodeSize/2+7).attr("y",function(e){var t=parseInt(p.AppUtils.getFontSize(this)),e=e.displayValue("aggregatedPayoff");return 1<(u.Utils.isArray(e)?e.filter(function(e){return void 0!==e}).length:1)?.6*t:Math.max(2,1.8*n.config.nodeSize/t)})}},{key:"nodeIndicatorPosition",value:function(e){return e.attr("x",this.config.nodeSize/2+8).attr("y",-this.config.nodeSize/2).attr("dominant-baseline","central").attr("text-anchor","middle")}},{key:"nodeUnfoldButtonPosition",value:function(e){return e.attr("x",this.config.nodeSize/2+5).attr("y",0).attr("dominant-baseline","central")}},{key:"edgeLineD",value:function(e){var t=c.line().x(function(e){return e[0]}).y(function(e){return e[1]}),n=e.parentNode,i=e.childNode,o=i.location.x-n.location.x,r=(i.location.y,n.location.y,0<=o?1:-1),a=Math.min(o/2,this.config.nodeSize/2+10),l=Math.min(this.config.edgeSlantWidthMax,Math.max(o/2-a,0)),s=[n.location.x+this.config.nodeSize/2+1,n.location.y],u=[Math.max(n.location.x+a,s[0]),n.location.y],l=[n.location.x+a+l,i.location.y],i=[i.location.x-r*Math.max(0,Math.min(this.config.nodeSize/2+8,o/2)),i.location.y];return e.$linePoints=[s,u,l,i],t(e.$linePoints)}},{key:"edgePayoffPosition",value:function(e){return s.setHangingPosition(e).attr("x",function(e){return e.$linePoints[2][0]+2}).attr("y",function(e){return e.$linePoints[2][1]+7}),e.selectAll("tspan").attr("x",function(e){return c.select(this.parentNode).datum().$linePoints[2][0]+2}),e}},{key:"edgeLabelPosition",value:function(e){return e.attr("transform",function(e){return"translate("+(e.$linePoints[2][0]+2)+","+(e.$linePoints[2][1]-7)+")"})}},{key:"edgeProbabilityPosition",value:function(e){return s.setHangingPosition(e).attr("x",function(e){var t=this.getComputedTextLength(),t=e.$linePoints[2][0]+2+this.previousSibling.childNodes[0].getComputedTextLength()+7+t;return Math.max(t,e.$linePoints[3][0]-8)}).attr("y",function(e){return e.$linePoints[2][1]+7})}},{key:"getMinMarginBetweenNodes",value:function(){return this.config.nodeSize+30}},{key:"getTextMinX",value:function(e){var t=0;return!e||(e=this.treeDesigner.getTextD3Selection(e).select("text").node().getBBox()).x<0&&(t-=e.x),t}},{key:"getTextMinY",value:function(e){var t=0;return!e||(e=this.treeDesigner.getTextD3Selection(e).select("text").node().getBBox()).y<0&&(t-=e.y),t}},{key:"getTextMaxX",value:function(e){return Number.MAX_SAFE_INTEGER}},{key:"getNodeMinX",value:function(e){return e&&e.$parent?e.$parent.location.x+this.getMinMarginBetweenNodes():this.config.nodeSize/2}},{key:"getNodeMinY",value:function(e){return this.config.nodeSize/2}},{key:"getNodeMaxX",value:function(e){return e&&e.childEdges.length?c.min(e.childEdges,function(e){return e.childNode.$hidden?9999999:e.childNode.location.x})-this.getMinMarginBetweenNodes():Number.MAX_SAFE_INTEGER}},{key:"setGridWidth",value:function(t,e){var n=this;this.config.gridWidth!==t&&(e||this.data.saveState({data:{gridWidth:n.config.gridWidth},onUndo:function(e){n.setGridWidth(e.gridWidth,!0)},onRedo:function(e){n.setGridWidth(t,!0)}}),this.config.gridWidth=t,this.update())}},{key:"setGridHeight",value:function(t,e){var n=this;this.config.gridHeight!==t&&(e||this.data.saveState({data:{gridHeight:n.config.gridHeight},onUndo:function(e){n.setGridHeight(e.gridHeight,!0)},onRedo:function(e){n.setGridHeight(t,!0)}}),this.config.gridHeight=t,this.update())}},{key:"setNodeSize",value:function(t,e){var n=this;this.config.nodeSize!==t&&(e||this.data.saveState({data:{nodeSize:n.config.nodeSize},onUndo:function(e){n.setNodeSize(e.nodeSize,!0)},onRedo:function(e){n.setNodeSize(t,!0)}}),this.config.nodeSize=t,this.update(),this.isManualLayout()&&(this.fitNodesInPlottingRegion(n.data.getRoots()),this.treeDesigner.redraw(!0)))}},{key:"setEdgeSlantWidthMax",value:function(t,e){var n=this;this.config.edgeSlantWidthMax!==t&&(e||this.data.saveState({data:{edgeSlantWidthMax:n.config.edgeSlantWidthMax},onUndo:function(e){n.setEdgeSlantWidthMax(e.edgeSlantWidthMax,!0)},onRedo:function(e){n.setEdgeSlantWidthMax(t,!0)}}),this.config.edgeSlantWidthMax=t,this.treeDesigner.redraw(!0))}},{key:"autoLayout",value:function(a,e){var l=this;if(e||this.data.saveState({data:{newLayout:a,currentLayout:l.config.type},onUndo:function(e){l.config.type=e.currentLayout,l._fireOnAutoLayoutChangedCallbacks()},onRedo:function(e){l.autoLayout(e.newLayout,!0)}}),this.config.type=a,this.data.nodes.length){var s=l.getNodeMinY();return this.data.getRoots().forEach(function(e){var t=c.hierarchy(e,function(e){return e.childEdges.filter(function(e){return!e.$hidden}).map(function(e){return e.childNode})});t.sort(function(e,t){return e.data.location.y-t.data.location.y}),(e="cluster"===a?c.cluster():c.tree()).nodeSize([l.config.gridHeight,l.config.gridWidth]),e.separation(l.nodeSeparation),e(t);var n=999999999;t.each(function(e){n=Math.min(n,e.x)});var i=t.x-n+s,o=l.getNodeMinX(),r=0;t.each(function(e){e.data.location.x=e.y+o,e.data.location.y=e.x+i,r=Math.max(r,e.data.location.y)}),s=r+l.config.nodeSize+l.treeMargin}),this.treeDesigner.redraw(!0),this._fireOnAutoLayoutChangedCallbacks(),this}this._fireOnAutoLayoutChangedCallbacks()}},{key:"fitNodesInPlottingRegion",value:function(e){var t=c.min(e,function(e){return e.location.y})-this.getNodeMinY(),n=c.min(e,function(e){return e.location.x})-this.getNodeMinX();(t<0||n<0)&&e.forEach(function(e){return e.move(-n,-t)})}},{key:"moveNodes",value:function(e,i,o,t){var r=this,a=r.config.limitNodePositioning;a&&(i<0?e.sort(function(e,t){return e.location.x-t.location.x}):e.sort(function(e,t){return t.location.x-e.location.x}));var n=c.min(e,function(e){return e.location.y});n+o<r.getNodeMinY()&&(o=r.getNodeMinY()-n),e.forEach(function(e){var t,n;a?(s.backupNodeLocation(e),t=r.getNodeMinX(e),n=r.getNodeMaxX(e),e.location.x=Math.min(Math.max(e.location.x+i,t),n)):e.location.x+=i,e.location.y+=o});var l=t&&r.config.limitNodePositioning&&t.location.x===t.$location.x;e.forEach(function(e){l&&(e.location.x=e.$location.x),r.treeDesigner.updateNodePosition(e)})}},{key:"moveTexts",value:function(e,o,r){var a=this,l=a.config.limitTextPositioning;l&&(o<0?e.sort(function(e,t){return e.location.x-t.location.x}):e.sort(function(e,t){return t.location.x-e.location.x})),e.forEach(function(e){var t,n,i;l?(t=a.getTextMinX(e),n=a.getTextMaxX(e),i=a.getTextMinY(e),e.location.x=Math.min(Math.max(e.location.x+o,t),n),e.location.y=Math.max(e.location.y+r,i)):e.location.move(o,r),a.treeDesigner.updateTextPosition(e)})}},{key:"_fireOnAutoLayoutChangedCallbacks",value:function(){var t=this;this.onAutoLayoutChanged.forEach(function(e){return e(t.config.type)})}}],[{key:"backupNodeLocation",value:function(e){e.$location=new d.domain.Point(e.location)}},{key:"setHangingPosition",value:function(e){return p.AppUtils.isHidden(e.node())||e.each(function(){this.getBBox().height;c.select(this).attr("dy","0.75em")}),e}}]),s}();(n.Layout=e).MANUAL_LAYOUT_NAME="manual"},{"./app-utils":16,"./d3":23,"./symbols/circle":34,"./symbols/triangle":35,"@babel/runtime/helpers/classCallCheck":4,"@babel/runtime/helpers/createClass":5,"@babel/runtime/helpers/interopRequireDefault":8,"@babel/runtime/helpers/typeof":14,"sd-model":"sd-model","sd-utils":"sd-utils"}],33:[function(e,t,n){"use strict";var i=e("@babel/runtime/helpers/interopRequireDefault"),a=e("@babel/runtime/helpers/typeof");Object.defineProperty(n,"__esModule",{value:!0}),n.NodeDragHandler=void 0;var o=i(e("@babel/runtime/helpers/classCallCheck")),r=i(e("@babel/runtime/helpers/createClass")),l=e("./app-utils"),s=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};t=d(t);if(t&&t.has(e))return t.get(e);var n,i={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var r;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((r=o?Object.getOwnPropertyDescriptor(e,n):null)&&(r.get||r.set)?Object.defineProperty(i,n,r):i[n]=e[n])}i.default=e,t&&t.set(e,i);return i}(e("./d3")),u=e("./context-menu/context-menu");function d(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(d=function(e){return e?n:t})(e)}n.NodeDragHandler=function(){function i(e,t){(0,o.default)(this,i),this.stateSnapshot=null,this.treeDesigner=e,this.data=t;var n=this;this.drag=s.drag().subject(function(e,t){if(null==t)return{x:e.x,y:e.y};e=s.select(this);return{x:e.attr("x")+l.AppUtils.getTranslation(e.attr("transform"))[0],y:e.attr("y")+l.AppUtils.getTranslation(e.attr("transform"))[1]}}).on("start",function(e,t){n.dragStarted.call(this,e,t,n)}).on("drag",function(e,t){n.onDrag.call(this,e,t,n)}).on("end",function(e,t){n.dragEnded.call(this,e,t,n)})}return(0,r.default)(i,[{key:"dragStarted",value:function(e,t,n){if(n.ignoreDrag)return n.ignoreDrag=!1,void(n.ignoredDrag=!0);n.ignoredDrag=!1,n.stateSnapshot=n.data.createStateSnapshot(),u.ContextMenu.hide();var i=s.select(this);i.classed("selected")||n.treeDesigner.clearSelection(),n.treeDesigner.selectNode(t),i.classed("selected dragging",!0),n.selectedNodes=n.treeDesigner.getSelectedNodes(!0),n.prevDragEvent=e,n.dragEventCount=0}},{key:"onDrag",value:function(e,t,n){var i,o;n.ignoredDrag||(2===n.dragEventCount&&n.stateSnapshot&&(n.data.saveStateFromSnapshot(n.stateSnapshot),n.stateSnapshot=null),n.dragEventCount++,5<n.selectedNodes.length&&n.dragEventCount%2!=1||(i=e.x-n.prevDragEvent.x,o=e.y-n.prevDragEvent.y,n.treeDesigner.layout.moveNodes(n.selectedNodes,i,o,t),n.prevDragEvent=e,n.treeDesigner.redrawEdges(),n.treeDesigner.updatePlottingRegionSize()))}},{key:"dragEnded",value:function(e,t,n){s.select(this).classed("dragging",!1);n.ignoredDrag||n.treeDesigner.layout.update(t)}},{key:"cancelDrag",value:function(){this.ignoreDrag=!0}}]),i}()},{"./app-utils":16,"./context-menu/context-menu":17,"./d3":23,"@babel/runtime/helpers/classCallCheck":4,"@babel/runtime/helpers/createClass":5,"@babel/runtime/helpers/interopRequireDefault":8,"@babel/runtime/helpers/typeof":14}],34:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=Math.PI;n.default={draw:function(e,t){var n=Math.sqrt(t/i),t=.552284749831*n;e.moveTo(-n,0),e.bezierCurveTo(-n,-t,-t,-n,0,-n),e.bezierCurveTo(t,-n,n,-t,n,0),e.bezierCurveTo(n,t,t,n,0,n),e.bezierCurveTo(-t,n,-n,t,-n,0)}}},{}],35:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;Math.sqrt(3);n.default={draw:function(e,t){t=Math.sqrt(t/Math.PI);e.moveTo(-t,0),e.lineTo(.9*t,-t),e.lineTo(.9*t,t),e.closePath()}}},{}],36:[function(e,t,n){"use strict";var i=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.Templates=void 0;var o=i(e("@babel/runtime/helpers/classCallCheck")),r=i(e("@babel/runtime/helpers/createClass")),a=e("sd-utils"),l=e("./i18n/i18n"),i=function(){function i(){(0,o.default)(this,i)}return(0,r.default)(i,null,[{key:"get",value:function(e,t){e=a.Utils.template(i[e],{imports:{i18n:l.i18n,Templates:i,include:function(e,t){return i.get(e,t)}}});return t?t.variables=t:t={variables:{}},e(t)}},{key:"styleRule",value:function(e,t){var n=e+"{";return t.forEach(function(e){return n+=i.styleProp(e[0],e[1])}),n+="} "}},{key:"styleProp",value:function(e,t){return e+": <%= "+t+" %>; "}},{key:"nodeSelector",value:function(e,t){var n=i.treeDesignerSelector+" .node";return e&&(n+="."+e+"-node"),t&&(n+="."+t),n}},{key:"edgeSelector",value:function(e){var t=i.treeDesignerSelector+" .edge";return e&&(t+="."+e),t}}]),i}();(n.Templates=i).growl=e("./templates/growl_message.html"),i.treeDesignerSelector="svg.sd-tree-designer",i.treeDesignerStyles=i.styleRule(i.treeDesignerSelector,[["font-size","fontSize"],["font-family","fontFamily"],["font-weight","fontWeight"],["font-style","fontStyle"]])+i.styleRule(i.nodeSelector()+" path",[["fill","node.fill"],["stroke-width","node.strokeWidth"]])+i.styleRule(i.nodeSelector("decision","optimal")+" path, "+i.nodeSelector("chance","optimal")+" path,"+i.nodeSelector("terminal","optimal")+" path",[["stroke","node.optimal.stroke"],["stroke-width","node.optimal.strokeWidth"]])+i.styleRule(i.nodeSelector()+" .label",[["font-size","node.label.fontSize"],["fill","node.label.color"]])+i.styleRule(i.nodeSelector()+" .payoff",[["font-size","node.payoff.fontSize"],["fill","node.payoff.color"]])+i.styleRule(i.nodeSelector()+" .payoff.negative",[["fill","node.payoff.negativeColor"]])+i.styleRule(i.nodeSelector("decision")+" path",[["fill","node.decision.fill"],["stroke","node.decision.stroke"]])+i.styleRule(i.nodeSelector("decision","selected")+" path",[["fill","node.decision.selected.fill"]])+i.styleRule(i.nodeSelector("chance")+" path",[["fill","node.chance.fill"],["stroke","node.chance.stroke"]])+i.styleRule(i.nodeSelector("chance","selected")+" path",[["fill","node.chance.selected.fill"]])+i.styleRule(i.nodeSelector("terminal")+" path",[["fill","node.terminal.fill"],["stroke","node.terminal.stroke"]])+i.styleRule(i.nodeSelector("terminal","selected")+" path",[["fill","node.terminal.selected.fill"]])+i.styleRule(i.nodeSelector("terminal")+" .aggregated-payoff",[["font-size","node.terminal.payoff.fontSize"],["fill","node.terminal.payoff.color"]])+i.styleRule(i.nodeSelector("terminal")+" .aggregated-payoff.negative",[["fill","node.terminal.payoff.negativeColor"]])+i.styleRule(i.treeDesignerSelector+" .node .probability-to-enter, "+i.treeDesignerSelector+" .edge .probability",[["font-size","probability.fontSize"],["fill","probability.color"]])+i.styleRule(i.edgeSelector()+" path",[["stroke","edge.stroke"],["stroke-width","edge.strokeWidth"]])+i.styleRule(i.treeDesignerSelector+" marker#arrow path",[["fill","edge.stroke"]])+i.styleRule(i.edgeSelector("optimal")+" path",[["stroke","edge.optimal.stroke"],["stroke-width","edge.optimal.strokeWidth"]])+i.styleRule(i.treeDesignerSelector+" marker#arrow-optimal path",[["fill","edge.optimal.stroke"]])+i.styleRule(i.edgeSelector("selected")+" path",[["stroke","edge.selected.stroke"],["stroke-width","edge.selected.strokeWidth"]])+i.styleRule(i.treeDesignerSelector+" marker#arrow-selected path",[["fill","edge.selected.stroke"]])+i.styleRule(i.edgeSelector()+" .label",[["font-size","edge.label.fontSize"],["fill","edge.label.color"]])+i.styleRule(i.edgeSelector()+" .payoff",[["font-size","edge.payoff.fontSize"],["fill","edge.payoff.color"]])+i.styleRule(i.edgeSelector()+" .payoff.negative",[["fill","edge.payoff.negativeColor"]])+i.styleRule(i.treeDesignerSelector+" .sd-title-container text.sd-title",[["font-size","title.fontSize"],["font-weight","title.fontWeight"],["font-style","title.fontStyle"],["fill","title.color"]])+i.styleRule(i.treeDesignerSelector+" .sd-title-container text.sd-description",[["font-size","description.fontSize"],["font-weight","description.fontWeight"],["font-style","description.fontStyle"],["fill","description.color"]])},{"./i18n/i18n":27,"./templates/growl_message.html":37,"@babel/runtime/helpers/classCallCheck":4,"@babel/runtime/helpers/createClass":5,"@babel/runtime/helpers/interopRequireDefault":8,"sd-utils":"sd-utils"}],37:[function(e,t,n){t.exports='module.exports = "<div class=\\"sd-growl-message <%=type%>\\">\\r\\n    <div class=\\"sd-growl-message-text\\">\\r\\n        <%= message %>\\r\\n    </div>\\r\\n</div>\\r\\n";\n'},{}],38:[function(e,t,n){"use strict";var i=e("@babel/runtime/helpers/interopRequireDefault"),a=e("@babel/runtime/helpers/typeof");Object.defineProperty(n,"__esModule",{value:!0}),n.TextDragHandler=void 0;var o=i(e("@babel/runtime/helpers/classCallCheck")),r=i(e("@babel/runtime/helpers/createClass")),l=e("./app-utils"),s=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};t=d(t);if(t&&t.has(e))return t.get(e);var n,i={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var r;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((r=o?Object.getOwnPropertyDescriptor(e,n):null)&&(r.get||r.set)?Object.defineProperty(i,n,r):i[n]=e[n])}i.default=e,t&&t.set(e,i);return i}(e("./d3")),u=e("./context-menu/context-menu");function d(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(d=function(e){return e?n:t})(e)}n.TextDragHandler=function(){function i(e,t){(0,o.default)(this,i),this.treeDesigner=e,this.data=t;var n=this;this.drag=s.drag().subject(function(e,t){if(null==t)return{x:e.x,y:e.y};e=s.select(this);return{x:e.attr("x")+l.AppUtils.getTranslation(e.attr("transform"))[0],y:e.attr("y")+l.AppUtils.getTranslation(e.attr("transform"))[1]}}).on("start",function(e,t){n.dragStarted.call(this,e,t,n)}).on("drag",function(e,t){n.onDrag.call(this,e,t,n)}).on("end",function(e,t){n.dragEnded.call(this,e,t,n)})}return(0,r.default)(i,[{key:"dragStarted",value:function(e,t,n){u.ContextMenu.hide();var i=s.select(this);i.classed("selected")||n.treeDesigner.clearSelection(),n.treeDesigner.selectText(t),i.classed("selected dragging",!0),n.selectedNodes=n.treeDesigner.getSelectedNodes(),n.prevDragEvent=e,n.dragEventCount=0}},{key:"onDrag",value:function(e,t,n){2==n.dragEventCount&&n.data.saveState(),n.dragEventCount++;var i=e.x-n.prevDragEvent.x,o=e.y-n.prevDragEvent.y;n.treeDesigner.layout.moveTexts([t],i,o),n.prevDragEvent=e,n.treeDesigner.updatePlottingRegionSize()}},{key:"dragEnded",value:function(e,t,n){s.select(this).classed("dragging",!1)}}]),i}()},{"./app-utils":16,"./context-menu/context-menu":17,"./d3":23,"@babel/runtime/helpers/classCallCheck":4,"@babel/runtime/helpers/createClass":5,"@babel/runtime/helpers/interopRequireDefault":8,"@babel/runtime/helpers/typeof":14}],39:[function(e,t,n){"use strict";var i=e("@babel/runtime/helpers/interopRequireDefault"),a=e("@babel/runtime/helpers/typeof");Object.defineProperty(n,"__esModule",{value:!0}),n.Tooltip=void 0;var o=i(e("@babel/runtime/helpers/classCallCheck")),r=i(e("@babel/runtime/helpers/createClass")),l=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var n,i={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var r;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((r=o?Object.getOwnPropertyDescriptor(e,n):null)&&(r.get||r.set)?Object.defineProperty(i,n,r):i[n]=e[n])}i.default=e,t&&t.set(e,i);return i}(e("./d3")),u=e("sd-utils");function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(s=function(e){return e?n:t})(e)}e=function(){function s(){(0,o.default)(this,s)}return(0,r.default)(s,null,[{key:"getContainer",value:function(){return l.select("body").selectOrAppend("div.sd-tooltip")}},{key:"show",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:5,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:28,i=3<arguments.length?arguments[3]:void 0,o=4<arguments.length&&void 0!==arguments[4]?arguments[4]:null,r=s.getContainer().style("opacity",0);r.transition().duration(200).style("opacity",.98),r.html(e),s.updatePosition(t,n,i),o&&setTimeout(function(){s.hide()},o)}},{key:"updatePosition",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:5,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:28,n=2<arguments.length?arguments[2]:void 0;s.getContainer().style("left",n.pageX+e+"px").style("top",n.pageY-t+"px")}},{key:"hide",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:500,t=s.getContainer();(t=e?t.transition().duration(e):t).style("opacity",0)}},{key:"attach",value:function(o,r,a,l){o.on("mouseover",function(e,t){var n=o.nodes().indexOf(this),i=null;null!=(i=u.Utils.isFunction(r)?r(t,n):r)&&""!==i?s.show(i,a,l,e):s.hide(0)}).on("mousemove",function(e,t){s.updatePosition(a,l,e)}).on("mouseout",function(e,t){s.hide()})}}]),s}();n.Tooltip=e},{"./d3":23,"@babel/runtime/helpers/classCallCheck":4,"@babel/runtime/helpers/createClass":5,"@babel/runtime/helpers/interopRequireDefault":8,"@babel/runtime/helpers/typeof":14,"sd-utils":"sd-utils"}],40:[function(e,t,n){"use strict";var i=e("@babel/runtime/helpers/interopRequireDefault"),a=e("@babel/runtime/helpers/typeof");Object.defineProperty(n,"__esModule",{value:!0}),n.TreeDesigner=n.TreeDesignerConfig=void 0;var o=i(e("@babel/runtime/helpers/toConsumableArray")),r=i(e("@babel/runtime/helpers/createClass")),l=i(e("@babel/runtime/helpers/classCallCheck")),u=w(e("./d3")),d=e("sd-utils"),s=e("./app-utils"),c=e("sd-model"),f=e("./context-menu/context-menu"),p=e("./context-menu/main-context-menu"),h=e("./context-menu/node-context-menu"),g=e("./layout"),y=e("./node-drag-handler"),b=e("./tooltip"),m=e("./templates"),v=e("./text-drag-handler"),x=e("./context-menu/text-context-menu"),k=e("./context-menu/edge-context-menu"),S=w(e("hammerjs")),N=e("./i18n/i18n");function P(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(P=function(e){return e?n:t})(e)}function w(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};t=P(t);if(t&&t.has(e))return t.get(e);var n,i,o={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((i=r?Object.getOwnPropertyDescriptor(e,n):null)&&(i.get||i.set)?Object.defineProperty(o,n,i):o[n]=e[n]);return o.default=e,t&&t.set(e,o),o}function M(e){(0,l.default)(this,M),this.width=void 0,this.height=void 0,this.margin={left:25,right:25,top:25,bottom:25},this.scale=1,this.lng="en",this.layout={type:"tree",nodeSize:40,limitNodePositioning:!0,limitTextPositioning:!0,gridHeight:75,gridWidth:150,edgeSlantWidthMax:20},this.fontFamily="sans-serif",this.fontSize="12px",this.fontWeight="normal",this.fontStyle="normal",this.node={strokeWidth:"1px",optimal:{stroke:"#006f00",strokeWidth:"1.5px"},label:{fontSize:"1em",color:"black"},payoff:{fontSize:"1em",color:"black",negativeColor:"#b60000"},decision:{fill:"#ff7777",stroke:"#660000",selected:{fill:"#aa3333"}},chance:{fill:"#ffff44",stroke:"#666600",selected:{fill:"#aaaa00"}},terminal:{fill:"#44ff44",stroke:"black",selected:{fill:"#00aa00"},payoff:{fontSize:"1em",color:"black",negativeColor:"#b60000"}}},this.edge={stroke:"#424242",strokeWidth:"1.5",optimal:{stroke:"#006f00",strokeWidth:"2.4"},selected:{stroke:"#045ad1",strokeWidth:"3.5"},label:{fontSize:"1em",color:"back"},payoff:{fontSize:"1em",color:"black",negativeColor:"#b60000"}},this.probability={fontSize:"1em",color:"#0000d7"},this.title={fontSize:"16px",fontWeight:"bold",fontStyle:"normal",color:"#000000",margin:{top:15,bottom:10}},this.description={show:!0,fontSize:"12px",fontWeight:"bold",fontStyle:"normal",color:"#000000",margin:{top:5,bottom:10}},this.readOnly=!1,this.disableAnimations=!1,this.forceFullEdgeRedraw=!1,this.hideLabels=!1,this.hidePayoffs=!1,this.hideProbabilities=!1,this.raw=!1,this.preserveFoldingOfNestedSubtrees=!0,this.payoffNumberFormatter=function(e,t){return e},this.probabilityNumberFormatter=function(e){return e},this.onNodeSelected=function(e){},this.onEdgeSelected=function(e){},this.onTextSelected=function(e){},this.onSelectionCleared=function(){},this.operationsForObject=function(e){return[]},this.performOperation=function(e,t){return Promise.resolve()},this.payoffNames=[null,null],this.maxPayoffsToDisplay=1,e&&d.Utils.deepExtend(this,e)}n.TreeDesignerConfig=M;e=function(){function i(e,t,n){(0,l.default)(this,i),this.setConfig(n),this.data=t,this.initContainer(e),this.init()}return(0,r.default)(i,[{key:"setConfig",value:function(e){return this.config=new M(e),this.layout&&(this.layout.config=this.config.layout),this.updateCustomStyles(),this}},{key:"init",value:function(){this.initSvg(),this.initLayout(),this.initI18n(),this.initBrush(),this.initEdgeMarkers(),this.updateCustomStyles(),this.config.readOnly||(this.initMainContextMenu(),this.initNodeContextMenu(),this.initEdgeContextMenu(),this.initNodeDragHandler(),this.initTextDragHandler(),this.initTextContextMenu()),this.redraw()}},{key:"initI18n",value:function(){N.i18n.init(this.config.lng)}},{key:"updateCustomStyles",value:function(){return u.select("head").selectOrAppend("style#sd-tree-designer-style").html(m.Templates.get("treeDesignerStyles",this.config)),this}},{key:"initLayout",value:function(){this.layout=new g.Layout(this,this.data,this.config.layout)}},{key:"initNodeDragHandler",value:function(){this.nodeDragHandler=new y.NodeDragHandler(this,this.data)}},{key:"initTextDragHandler",value:function(){this.textDragHandler=new v.TextDragHandler(this,this.data)}},{key:"redraw",value:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=this,e=!t.config.disableAnimations&&e;return this.redrawDiagramTitle(),this.redrawDiagramDescription(),this.updateScale(e),this.updateMargin(e),e&&(t.transitionPrev=t.transition,t.transition=!0),this.redrawNodes(),this.redrawEdges(),this.redrawFloatingTexts(),this.updateValidationMessages(),e&&(t.transition=t.transitionPrev),setTimeout(function(){t.updatePlottingRegionSize()},10),this}},{key:"computeAvailableSpace",value:function(){this.availableHeight=s.AppUtils.sanitizeHeight(this.config.height,this.container,this.config.margin),this.availableWidth=s.AppUtils.sanitizeWidth(this.config.width,this.container,this.config.margin)}},{key:"initSvg",value:function(){var e=this;this.computeAvailableSpace(),this.svg=this.container.selectOrAppend("svg.sd-tree-designer"),this.svg.attr("width",this.availableWidth).attr("height",this.availableHeight),this.wrapperGroup=this.svg.selectOrAppend("g.sd-wrapper-group"),this.mainGroup=this.wrapperGroup.selectOrAppend("g.main-group"),this.updateScale(),this.updateMargin(),this.config.width||u.select(window).on("resize.tree-designer",function(){e.updatePlottingRegionSize(),e.redrawDiagramTitle()});var t=new S.Manager(this.svg.node(),{touchAction:"auto"});t.add(new S.Press({pointerType:"touch"})),t.add(new S.Pinch({pointerType:"touch"})),t.on("pinchstart",function(){e.disableBrush()}),t.on("pinch",function(){d.Utils.waitForFinalEvent(function(){return e.enableBrush()},"pinchend",5e3)})}},{key:"updateMargin",value:function(e){var t=this,n=this.config.margin,i=this.mainGroup;e&&(i=i.transition()),this.topMargin=n.top,(this.diagramTitle||this.diagramDescription)&&(this.topMargin=parseInt(this.diagramTitle?this.config.title.margin.top:0)+this.getTitleGroupHeight()+Math.max(this.topMargin,parseInt(this.config.title.margin.bottom))),i.attr("transform","translate("+n.left+","+this.topMargin+")").on("end",function(){return t.updatePlottingRegionSize()})}},{key:"setMargin",value:function(t,e){var n=this;e||this.data.saveState({data:{margin:d.Utils.clone(n.config.margin)},onUndo:function(e){n.setMargin(e.margin,!0)},onRedo:function(e){n.setMargin(t,!0)}}),d.Utils.deepExtend(this.config.margin,t),this.redrawDiagramTitle(),this.updateMargin(!0)}},{key:"updateScale",value:function(e){var t=this,n=this.config.scale,i=this.wrapperGroup;(i=e?i.transition():i).attr("transform","scale("+n+")").on("end",function(){return t.updatePlottingRegionSize()})}},{key:"setScale",value:function(t,e){var n=this;e||this.data.saveState({data:{scale:d.Utils.clone(n.config.scale)},onUndo:function(e){n.setScale(e.scale,!0)},onRedo:function(e){n.setScale(t,!0)}}),this.config.scale=t,this.updateScale(!0)}},{key:"initContainer",value:function(e){var t;d.Utils.isString(e)?(t=e.trim(),d.Utils.startsWith(t,"#")||d.Utils.startsWith(t,".")||(t="#"+t),this.container=u.select(t)):e._parents?this.container=e:this.container=u.select(e)}},{key:"updatePlottingRegionSize",value:function(){var e=!1;this.computeAvailableSpace();var t=this.config.margin,n=this.svg.attr("width"),i=this.svg.attr("height"),o=this.mainGroup.node().getBBox(),r=o.width+o.x+t.left+t.right;r*=this.config.scale,this.container.classed("with-overflow-x",r>=this.availableWidth),n!=(r=Math.max(r,this.availableWidth))&&(e=!0,this.svg.attr("width",r));t=o.height+o.y+this.topMargin+t.bottom;t*=this.config.scale,this.container.classed("with-overflow-y",t>=this.availableHeight),i!=(t=Math.max(t,this.availableHeight))&&(e=!0,this.svg.attr("height",t)),e&&this.updateBrushExtent()}},{key:"redrawNodes",value:function(){var i=this,e=this.mainGroup.selectOrAppend("g.nodes").selectAll(".node").data(this.data.nodes.filter(function(e){return!e.$hidden}),function(e,t){return e.id});e.exit().remove();var t=e.enter().append("g").attr("id",function(e){return"node-"+e.id}).attr("class",function(e){return e.type+"-node node"}).attr("transform",function(e){return"translate("+e.location.x+"  "+e.location.y+")"});t.append("path");var n=t.append("text").attr("class","label"),o=t.append("text").attr("class","payoff computed"),r=t.append("text").attr("class","error-indicator").text("!!"),a=t.append("text").attr("class","aggregated-payoff"),l=t.append("text").attr("class","probability-to-enter"),s=t.merge(e);s.classed("optimal",function(e){return i.isOptimal(e)});t=s;this.transition&&(t=s.transition()).on("end",function(){return i.updatePlottingRegionSize()}),t.attr("transform",function(e){return"translate("+e.location.x+"  "+e.location.y+")"});e=s.select("path");this.layout.drawNodeSymbol(e,this.transition),this.layout.nodeLabelPosition(n),s.select("text.label").classed("sd-hidden",this.config.hideLabels);n=t.select("text.label");n.each(this.updateTextLines),this.layout.nodeLabelPosition(n).attr("text-anchor","middle");t=s.select("text.payoff"),n=t.selectAll("tspan").data(function(e){e=e.displayValue("childrenPayoff");return d.Utils.isArray(e)?e.filter(function(e){return void 0!==e}):[e]});n.exit().remove();n=n.enter().append("tspan").merge(n);n.attr("dy",function(e,t){return 0<t?"1.1em":void 0}).attr("x","0").classed("negative",function(e){return null!==e&&e<0}).classed("sd-hidden",this.config.hidePayoffs||this.config.raw).text(function(e,t){return null!==e?isNaN(e)?e:i.config.payoffNumberFormatter(e,t):""}),this.attachPayoffTooltip(n);n=t;this.transition&&(n=t.transition()),this.layout.nodePayoffPosition(o),this.layout.nodePayoffPosition(n);o=s.select("text.aggregated-payoff"),n=o.selectAll("tspan").data(function(e){e=e.displayValue("aggregatedPayoff");return d.Utils.isArray(e)?e.filter(function(e){return void 0!==e}):[e]});n.exit().remove();n=n.enter().append("tspan").merge(n).attr("dy",function(e,t){return 0<t?"0.95em":void 0}).classed("negative",function(e){return null!==e&&e<0}).classed("sd-hidden",this.config.hidePayoffs||this.config.raw).text(function(e,t){return null!==e?isNaN(e)?e:i.config.payoffNumberFormatter(e,t):""});this.attachPayoffTooltip(n,"aggregatedPayoff");n=o;this.transition&&(n=o.transition()),this.layout.nodeAggregatedPayoffPosition(a),this.layout.nodeAggregatedPayoffPosition(n);a=s.select("text.probability-to-enter").text(function(e){e=e.displayValue("probabilityToEnter");return null!==e?isNaN(e)?e:i.config.probabilityNumberFormatter(e):""}).classed("sd-hidden",this.config.hideProbabilities||this.config.raw);b.Tooltip.attach(a,N.i18n.t("tooltip.node.probabilityToEnter"));n=a;this.transition&&(n=a.transition()),this.layout.nodeProbabilityToEnterPosition(l),this.layout.nodeProbabilityToEnterPosition(n);n=s.select("text.error-indicator");n.classed("sd-hidden",this.config.raw),this.layout.nodeIndicatorPosition(r),this.layout.nodeIndicatorPosition(n),this.nodeDragHandler&&s.call(this.nodeDragHandler.drag),s.on("contextmenu",this.nodeContextMenu),s.on("dblclick",this.nodeContextMenu),s.each(function(e,t){var n=new S.Manager(this);n.add(new S.Press({pointerType:"touch"})),n.on("press",function(e){"touch"==e.pointerType&&i.nodeDragHandler.cancelDrag()}),e.folded?(n=u.select(this).selectOrAppend("text.sd-unfold-button").text("[+]").on("click dbclick mousedown",function(){return i.foldSubtree(e,!1)}),i.layout.nodeUnfoldButtonPosition(n),b.Tooltip.attach(n,N.i18n.t("contextMenu.node.unfold"))):u.select(this).select(".sd-unfold-button").remove()})}},{key:"attachPayoffTooltip",value:function(e){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"payoff",i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"node",o=this;b.Tooltip.attach(e,function(e,t){return o.config.payoffNames.length>t&&null!==o.config.payoffNames[t]?N.i18n.t("tooltip."+i+"."+n+".named",{value:e.payoff,number:t+1,name:o.config.payoffNames[t]}):N.i18n.t("tooltip."+i+"."+n+".default",{value:e.payoff,number:o.config.maxPayoffsToDisplay<2?"":t+1})})}},{key:"updateTextLines",value:function(e){e=e.displayValue("name")||e.name,e=e?e.split("\n"):[];e.reverse();e=u.select(this).selectAll("tspan").data(e);e.enter().append("tspan").merge(e).text(function(e){return e}).attr("dy",function(e,t){return 0<t?"-1.1em":void 0}).attr("x","0"),e.exit().remove()}},{key:"isOptimal",value:function(e){return e.displayValue("optimal")}},{key:"redrawEdges",value:function(){var i=this,o=this,e=this.mainGroup.selectOrAppend("g.edges");o.config.forceFullEdgeRedraw&&e.selectAll("*").remove();var t=e.selectAll(".edge").data(this.data.edges.filter(function(e){return!e.$hidden}),function(e,t){return e.id});t.exit().remove();var n=t.enter().append("g").attr("id",function(e){return"edge-"+e.id}).attr("class","edge");n.append("path");var r=n.appendSelector("g.label-group");r.append("text").attr("class","label");var a=n.append("text").attr("class","payoff"),l=n.append("text").attr("class","probability"),s=n.merge(t),n="optimal";s.classed(n,function(e){return o.isOptimal(e)});t=s;(t=this.transition?s.transition():t).select("path").attr("d",function(e){return i.layout.edgeLineD(e)}).attr("fill","none").attr("marker-end",function(e){return"url(#arrow"+(u.select(this.parentNode).classed("selected")?"-selected":o.isOptimal(e)?"-optimal":"")+")"}),s.on("click",function(e,t){o.selectEdge(t,!0)}),this.layout.edgeLabelPosition(r),t.select("text.label").each(this.updateTextLines),s.select("g.label-group").classed("sd-hidden",this.config.hideLabels);r=t.select("g.label-group");this.layout.edgeLabelPosition(r);t=s.select("text.payoff"),r=t.selectAll("tspan").data(function(t){var e=t.displayValue("payoff");return d.Utils.isArray(e)?e.slice(0,Math.min(e.length,o.config.maxPayoffsToDisplay)).map(function(e){return t}):[t]});r.exit().remove();r=r.enter().append("tspan").merge(r);r.attr("dy",function(e,t){return 0<t?"1.1em":void 0}).classed("negative",function(e,t){t=e.displayPayoff(void 0,t);return null!==t&&t<0}).classed("sd-hidden",this.config.hidePayoffs).text(function(e,t){if(i.config.raw)return e.payoff[t];var n=e.displayValue("payoff"),n=(d.Utils.isArray(n)?n:[n])[t];if(null!==n){if(!isNaN(n))return o.config.payoffNumberFormatter(n,t);if(d.Utils.isString(n))return n}return null===e.payoff[t]||isNaN(e.payoff[t])?e.payoff[t]:o.config.payoffNumberFormatter(e.payoff[t],t)}),b.Tooltip.attach(r,function(e,t){return o.config.payoffNames.length>t&&null!==o.config.payoffNames[t]?N.i18n.t("tooltip.edge.payoff.named",{value:e.payoff[t],number:t+1,name:o.config.payoffNames[t]}):N.i18n.t("tooltip.edge.payoff.default",{value:e.payoff[t],number:o.config.maxPayoffsToDisplay<2?"":t+1})});r=t;this.transition&&(r=t.transition()),this.layout.edgePayoffPosition(a),this.layout.edgePayoffPosition(r),b.Tooltip.attach(s.select("text.probability"),function(e){return N.i18n.t("tooltip.edge.probability",{value:void 0===e.probability?e.displayProbability():e.probability})}),s.select("text.probability").classed("sd-hidden",this.config.hideProbabilities);a=s.select("text.probability");a.attr("text-anchor","end").text(function(e){if(i.config.raw)return e.probability;var t=e.displayProbability();if(null!==t){if(!isNaN(t))return o.config.probabilityNumberFormatter(t);if(d.Utils.isString(t))return t}return null===e.probability||isNaN(e.probability)?e.probability:o.config.probabilityNumberFormatter(e.probability)});r=a;this.transition&&(r=a.transition()),this.layout.edgeProbabilityPosition(l),this.layout.edgeProbabilityPosition(r),e.selectAll(".edge."+n).raise(),s.on("contextmenu",this.edgeContextMenu),s.on("dblclick",this.edgeContextMenu),s.each(function(e,t){new S.Manager(this).add(new S.Press({pointerType:S.POINTER_TOUCH}))})}},{key:"redrawFloatingTexts",value:function(){var e=this.mainGroup.selectOrAppend("g.floating-texts").selectAll(".floating-text").data(this.data.texts,function(e,t){return e.id});e.exit().remove();var t=e.enter().appendSelector("g.floating-text").attr("id",function(e){return"text-"+e.id});t.append("rect").attr("x",-5).attr("y",-16).attr("fill-opacity",0),t.append("text");t=t.merge(e),e=t;(e=this.transition?t.transition():e).attr("transform",function(e){return"translate("+e.location.x+"  "+e.location.y+")"});e=t.select("text").selectAll("tspan").data(function(e){e=e.$displayValue||e.value;return e?e.split("\n"):[]});e.enter().append("tspan").merge(e).html(function(e){return s.AppUtils.replaceUrls(s.AppUtils.escapeHtml(e))}).attr("dy",function(e,t){return 0<t?"1.1em":void 0}).attr("x","0"),e.exit().remove(),t.classed("sd-empty",function(e){return!e.value||!e.value.trim()}),t.select("rect").attr("width",40).attr("height",20),t.each(function(e){e.value&&(e=u.select(this).select("text").node().getBBox(),u.select(this).select("rect").attr("y",e.y-5).attr("width",Math.max(e.width+10,40)).attr("height",Math.max(e.height+10,20)))}),this.textDragHandler&&t.call(this.textDragHandler.drag),t.on("contextmenu",this.textContextMenu),t.on("dblclick",this.textContextMenu),t.each(function(e,t){new S.Manager(this).add(new S.Press({pointerType:"touch"}))})}},{key:"updateValidationMessages",value:function(){var o=this;this.mainGroup.selectAll(".node").classed("error",!1),this.data.validationResults.forEach(function(i){i.isValid()||Object.getOwnPropertyNames(i.objectIdToError).forEach(function(e){var t=i.objectIdToError[e],e=o.getNodeD3SelectionById(e);e.classed("error",!0);var n="";t.forEach(function(e){n&&(n+="<br/>"),n+=s.AppUtils.getValidationMessage(e)}),b.Tooltip.attach(e.select(".error-indicator"),n)})})}},{key:"initEdgeMarkers",value:function(){this.svg.append("svg:defs");this.initArrowMarker("arrow"),this.initArrowMarker("arrow-optimal"),this.initArrowMarker("arrow-selected")}},{key:"initArrowMarker",value:function(e){this.svg.select("defs").append("marker").attr("id",e).attr("viewBox","0 -5 10 10").attr("refX",5).attr("refY",0).attr("markerWidth",4).attr("markerHeight",4).attr("orient","auto").append("path").attr("d","M0,-5L10,0L0,5").attr("class","arrowHead")}},{key:"updateBrushExtent",value:function(){this.brush.extent([[0,0],[this.svg.attr("width"),this.svg.attr("height")]]),this.brushContainer.call(this.brush)}},{key:"initBrush",value:function(){var l=this,t=l.brushContainer=this.brushContainer=this.wrapperGroup.selectOrInsert("g.brush",":first-child").attr("class","brush"),n=this.brush=u.brush().on("start",function(e){e.selection&&(l.hoveredEdge?l.selectEdge(l.hoveredEdge.datum(),!0):l.clearSelection(),f.ContextMenu.hide())}).on("brush",function(e){var i=e.selection;i&&l.mainGroup.selectAll(".node").classed("selected",function(e){var t=l.getMainGroupTranslation(),n=e.location.x+t[0],e=e.location.y+t[1],t=.25*l.config.layout.nodeSize;return i[0][0]<=n+t&&n-t<=i[1][0]&&i[0][1]<=e+t&&e-t<=i[1][1]})}).on("end",function(e){e.selection&&(n.move(t,null),(e=l.getSelectedNodes())&&1===e.length&&l.selectNode(e[0]))});this.updateBrushExtent(),t.select(".overlay").on("mousemove.edgeSelection",function(e){var o=u.pointer(e),r=l.getMainGroupTranslation(),a=[null,999999999];l.mainGroup.selectAll(".edge").each(function(e){var t=u.select(this);t.classed("sd-hover",!1);var n=t.select("path").node(),i=n.getBBox();i.x+r[0]<=o[0]&&i.x+i.width+r[0]>=o[0]&&i.y+r[1]-10<=o[1]&&i.y+i.height+r[1]+10>=o[1]&&((n=s.AppUtils.closestPoint(n,[o[0]-r[0],o[1]-r[1]])).distance<10&&n.distance<a[1]&&(a=[t,n.distance]))}),l.hoveredEdge=null,a[0]&&(a[0].classed("sd-hover",!0),l.hoveredEdge=a[0])})}},{key:"disableBrush",value:function(){this.brushDisabled||s.AppUtils.growl(N.i18n.t("growl.brushDisabled"),"info","left"),this.brushDisabled=!0,this.brushContainer.remove()}},{key:"enableBrush",value:function(){this.brushDisabled&&(s.AppUtils.growl(N.i18n.t("growl.brushEnabled"),"info","left"),this.initBrush(),this.brushDisabled=!1)}},{key:"getMainGroupTranslation",value:function(e){var t=s.AppUtils.getTranslation(this.mainGroup.attr("transform"));return e&&(t[0]=-t[0],t[1]=-t[1]),t}},{key:"initNodeContextMenu",value:function(){this.nodeContextMenu=new h.NodeContextMenu(this,this.config.operationsForObject)}},{key:"initEdgeContextMenu",value:function(){this.edgeContextMenu=new k.EdgeContextMenu(this)}},{key:"initTextContextMenu",value:function(){this.textContextMenu=new x.TextContextMenu(this)}},{key:"initMainContextMenu",value:function(){this.mainContextMenu=new p.MainContextMenu(this),this.svg.on("contextmenu",this.mainContextMenu),this.svg.on("dblclick",this.mainContextMenu)}},{key:"addText",value:function(e){this.data.saveState(),this.data.addText(e),this.redraw(),this.selectText(e)}},{key:"addNode",value:function(e,t){return this.data.saveState(),this.data.addNode(e,t),this.redraw(!0),this.layout.update(e),e}},{key:"addDecisionNode",value:function(e){var t=new c.domain.DecisionNode(this.layout.getNewChildLocation(e));this.addNode(t,e)}},{key:"addChanceNode",value:function(e){var t=new c.domain.ChanceNode(this.layout.getNewChildLocation(e));this.addNode(t,e)}},{key:"addTerminalNode",value:function(e){var t=new c.domain.TerminalNode(this.layout.getNewChildLocation(e));this.addNode(t,e)}},{key:"injectNode",value:function(e,t){return this.data.saveState(),this.data.injectNode(e,t),this.redraw(),this.layout.update(e),e}},{key:"injectDecisionNode",value:function(e){var t=new c.domain.DecisionNode(this.layout.getInjectedNodeLocation(e));this.injectNode(t,e)}},{key:"injectChanceNode",value:function(e){var t=new c.domain.ChanceNode(this.layout.getInjectedNodeLocation(e));this.injectNode(t,e)}},{key:"removeNode",value:function(e){this.data.saveState(),this.data.removeNode(e),this.layout.isManualLayout()?this.redraw():this.layout.update()}},{key:"removeSelectedNodes",value:function(){var e=this.getSelectedNodes();e.length&&(this.data.saveState(),this.data.removeNodes(e),this.clearSelection(),this.redraw(),this.layout.update())}},{key:"removeSelectedTexts",value:function(){var e=this.getSelectedTexts();e.length&&(this.data.saveState(),this.data.removeTexts(e),this.clearSelection(),this.redraw())}},{key:"copyNode",value:function(e,t){e=this.data.cloneSubtree(e);t?(this.copiedNodes||(this.copiedNodes=[]),this.copiedNodes.push(e)):this.copiedNodes=[e]}},{key:"cutNode",value:function(e){this.copyNode(e),this.removeNode(e)}},{key:"cutSelectedNodes",value:function(){var e=this.getSelectedNodes(),e=this.data.findSubtreeRoots(e);this.copyNodes(e),this.removeSelectedNodes()}},{key:"copySelectedNodes",value:function(){var e=this.getSelectedNodes(),e=this.data.findSubtreeRoots(e);this.copyNodes(e)}},{key:"copyNodes",value:function(e){var t=this;this.copiedNodes=e.map(function(e){return t.data.cloneSubtree(e)})}},{key:"pasteToNode",value:function(n){var i,o,r=this;this.copiedNodes&&this.copiedNodes.length&&(this.data.saveState(),(i=this).clearSelection(),o=this.copiedNodes,i.copyNodes(this.copiedNodes),o.forEach(function(e){var t=r.data.attachSubtree(e,n).childNode;t.folded&&i.foldSubtree(t,t.folded,!1);e=i.layout.getNewChildLocation(n);t.moveTo(e.x,e.y,!0),i.layout.moveNodeToEmptyPlace(t,!1),i.layout.fitNodesInPlottingRegion(r.data.getAllDescendantNodes(t)),i.selectSubTree(t,!1,1<o.length)}),n.folded&&i.foldSubtree(n,n.folded,!1),setTimeout(function(){i.redraw(),i.layout.update()},10))}},{key:"pasteToNewLocation",value:function(t){var n=this;this.data.saveState();var i=this;i.clearSelection();var o=this.copiedNodes;i.copyNodes(this.copiedNodes),o.forEach(function(e){e=n.data.attachSubtree(e);e.folded&&i.foldSubtree(e,e.folded,!1),e.moveTo(t.x,t.y,!0),i.layout.moveNodeToEmptyPlace(e,!1),i.layout.fitNodesInPlottingRegion(n.data.getAllDescendantNodes(e)),i.selectSubTree(e,!1,1<o.length)}),setTimeout(function(){i.redraw(),i.layout.update()},10)}},{key:"convertNode",value:function(e,t){var n=this;this.data.saveState(),this.data.convertNode(e,t),setTimeout(function(){n.redraw(!0)},10)}},{key:"performOperation",value:function(e,t){var n=this;this.data.saveState(),this.config.performOperation(e,t).then(function(){setTimeout(function(){n.redraw(),n.layout.update()},10)})}},{key:"foldSubtree",value:function(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],n=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],i=this;e.folded=t;var o=i.config.preserveFoldingOfNestedSubtrees;this.data.getAllDescendantNodes(e).forEach(function(e){e.$hidden=t||e.$parent&&(e.$parent.folded||e.$parent.$hidden),o||(e.folded=!1)}),this.data.getAllDescendantEdges(e).forEach(function(e){return e.$hidden=e.parentNode.folded||e.parentNode.$hidden}),n&&setTimeout(function(){i.redraw(),i.layout.update()},10)}},{key:"updateVisibility",value:function(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;e?e.folded?this.foldSubtree(e,!0,!1):e.childEdges.forEach(function(e){return t.updateVisibility(e.childNode)}):this.data.getRoots().forEach(function(e){return t.updateVisibility(e)})}},{key:"moveNodeTo",value:function(e,t){}},{key:"updateNodePosition",value:function(e){this.getNodeD3Selection(e).raise().attr("transform","translate("+e.location.x+" "+e.location.y+")")}},{key:"updateTextPosition",value:function(e){this.getTextD3Selection(e).raise().attr("transform","translate("+e.location.x+" "+e.location.y+")")}},{key:"getNodeD3Selection",value:function(e){return this.getNodeD3SelectionById(e.id)}},{key:"getNodeD3SelectionById",value:function(e){return this.mainGroup.select("#node-"+e)}},{key:"getTextD3Selection",value:function(e){return this.getTextD3SelectionById(e.id)}},{key:"getTextD3SelectionById",value:function(e){return this.mainGroup.select("#text-"+e)}},{key:"getSelectedNodes",value:function(){var t=this,e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],n=this.mainGroup.selectAll(".node.selected").data();if(e)return n;var i=[];return i.push.apply(i,(0,o.default)(n)),n.forEach(function(e){!e.folded||(e=t.data.getAllDescendantNodes(e))&&i.push.apply(i,(0,o.default)(e))}),i}},{key:"getSelectedTexts",value:function(){return this.mainGroup.selectAll(".floating-text.selected").data()}},{key:"clearSelection",value:function(){var t=this;this.mainGroup.selectAll(".edge.selected").select("path").attr("marker-end",function(e){return"url(#arrow"+(t.isOptimal(e)?"-optimal":"")+")"}),this.mainGroup.selectAll(".selected").classed("selected",!1),this.config.onSelectionCleared()}},{key:"selectEdge",value:function(e,t){t&&this.clearSelection(),this.config.onEdgeSelected(e),this.mainGroup.select("#edge-"+e.id).classed("selected",!0).select("path").attr("marker-end",function(e){return"url(#arrow-selected)"})}},{key:"isNodeSelected",value:function(e){return this.getNodeD3Selection(e).classed("selected")}},{key:"selectNode",value:function(e,t,n){t&&this.clearSelection(),n||this.config.onNodeSelected(e),this.getNodeD3SelectionById(e.id).classed("selected",!0)}},{key:"selectText",value:function(e,t,n){t&&this.clearSelection(),n||this.config.onTextSelected(e),this.getTextD3SelectionById(e.id).classed("selected",!0)}},{key:"selectSubTree",value:function(e,t,n){var i=this;t&&this.clearSelection(),this.selectNode(e,!1,n),e.childEdges.forEach(function(e){return i.selectSubTree(e.childNode,!1,!0)})}},{key:"selectAllNodes",value:function(){this.mainGroup.selectAll(".node").classed("selected",!0)}},{key:"autoLayout",value:function(e,t){this.layout.autoLayout(e,t)}},{key:"updateDiagramTitle",value:function(e){this.diagramTitle=e=e||"",this.redrawDiagramTitle(),this.redrawDiagramDescription(),this.updateMargin(!0)}},{key:"redrawDiagramTitle",value:function(){var e=this.svg.attr("width");this.svg.attr("height");this.titleContainer=this.svg.selectOrAppend("g.sd-title-container");var t=this.titleContainer.selectOrAppend("text.sd-title");t.text(this.diagramTitle),g.Layout.setHangingPosition(t);t=parseInt(this.config.title.margin.top);this.titleContainer.attr("transform","translate("+e/2+","+t+")")}},{key:"redrawDiagramDescription",value:function(){this.svg.attr("width"),this.svg.attr("height");this.titleContainer=this.svg.selectOrAppend("g.sd-title-container");var e,t,n=this.titleContainer.selectOrAppend("text.sd-description");this.config.description.show?(e=this.diagramDescription?this.diagramDescription.split("\n"):[],(t=n.selectAll("tspan").data(e)).enter().append("tspan").merge(t).html(function(e){return s.AppUtils.replaceUrls(s.AppUtils.escapeHtml(e))}).attr("dy",function(e,t){return 0<t?"1.1em":void 0}).attr("x","0"),t.exit().remove(),g.Layout.setHangingPosition(n),e=this.titleContainer.selectOrAppend("text.sd-title"),t=0,this.diagramTitle&&(t+=e.node().getBBox().height,t+=Math.max(parseInt(this.config.description.margin.top),0)),n.attr("transform","translate(0,"+t+")")):n.remove()}},{key:"updateDiagramDescription",value:function(e){this.diagramDescription=e=e||"",this.redrawDiagramTitle(),this.redrawDiagramDescription(),this.updateMargin(!0)}},{key:"getTitleGroupHeight",value:function(e){if(!this.titleContainer)return 0;var t=this.titleContainer.node().getBBox().height;return e&&(t+=parseInt(this.config.title.margin.bottom),t+=parseInt(this.config.title.margin.top)),t}}]),i}();n.TreeDesigner=e},{"./app-utils":16,"./context-menu/context-menu":17,"./context-menu/edge-context-menu":18,"./context-menu/main-context-menu":19,"./context-menu/node-context-menu":20,"./context-menu/text-context-menu":21,"./d3":23,"./i18n/i18n":27,"./layout":32,"./node-drag-handler":33,"./templates":36,"./text-drag-handler":38,"./tooltip":39,"@babel/runtime/helpers/classCallCheck":4,"@babel/runtime/helpers/createClass":5,"@babel/runtime/helpers/interopRequireDefault":8,"@babel/runtime/helpers/toConsumableArray":13,"@babel/runtime/helpers/typeof":14,hammerjs:"hammerjs","sd-model":"sd-model","sd-utils":"sd-utils"}],"sd-tree-designer":[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=e("./src/index");Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in n&&n[e]===i[e]||Object.defineProperty(n,e,{enumerable:!0,get:function(){return i[e]}}))})},{"./src/index":31}]},{},[]);
//# sourceMappingURL=sd-tree-designer.min.js.map
